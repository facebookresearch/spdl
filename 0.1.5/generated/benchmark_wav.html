<!doctype html>
<html class="no-js" lang="en" data-content_root="../">
  <head><meta charset="utf-8"/>
    <meta name="viewport" content="width=device-width,initial-scale=1"/>
    <meta name="color-scheme" content="light dark"><meta name="viewport" content="width=device-width, initial-scale=1" />
<link rel="index" title="Index" href="../genindex.html" /><link rel="search" title="Search" href="../search.html" /><link rel="next" title="Benchmark tarfile" href="benchmark_tarfile.html" /><link rel="prev" title="Pipeline profiling" href="pipeline_profiling.html" />

    <!-- Generated with Sphinx 7.4.7 and Furo 2024.07.18 -->
        <title>Benchmark wav - SPDL 0.1.5 documentation</title>
      <link rel="stylesheet" type="text/css" href="../_static/pygments.css?v=8f2a1f02" />
    <link rel="stylesheet" type="text/css" href="../_static/styles/furo.css?v=613ab9ff" />
    <link rel="stylesheet" type="text/css" href="../_static/collapsible-lists/css/tree_view.css?v=a885cde7" />
    <link rel="stylesheet" type="text/css" href="../_static/styles/furo-extensions.css?v=302659d7" />
    <link rel="stylesheet" type="text/css" href="../_static/css/custom.css?v=a8e03d5d" />
    
    


<style>
  body {
    --color-code-background: #f8f8f8;
  --color-code-foreground: black;
  
  }
  @media not print {
    body[data-theme="dark"] {
      --color-code-background: #202020;
  --color-code-foreground: #d0d0d0;
  
    }
    @media (prefers-color-scheme: dark) {
      body:not([data-theme="light"]) {
        --color-code-background: #202020;
  --color-code-foreground: #d0d0d0;
  
      }
    }
  }
</style>
<!-- Google tag (gtag.js) -->
<script async src="https://www.googletagmanager.com/gtag/js?id=G-SNXS50Q2E3"></script>
<script>
  window.dataLayer = window.dataLayer || [];
  function gtag(){dataLayer.push(arguments);}
  gtag('js', new Date());

  gtag('config', 'G-SNXS50Q2E3');
</script>
</head>
  <body>
    
    <script>
      document.body.dataset.theme = localStorage.getItem("theme") || "auto";
    </script>
    

<svg xmlns="http://www.w3.org/2000/svg" style="display: none;">
  <symbol id="svg-toc" viewBox="0 0 24 24">
    <title>Contents</title>
    <svg stroke="currentColor" fill="currentColor" stroke-width="0" viewBox="0 0 1024 1024">
      <path d="M408 442h480c4.4 0 8-3.6 8-8v-56c0-4.4-3.6-8-8-8H408c-4.4 0-8 3.6-8 8v56c0 4.4 3.6 8 8 8zm-8 204c0 4.4 3.6 8 8 8h480c4.4 0 8-3.6 8-8v-56c0-4.4-3.6-8-8-8H408c-4.4 0-8 3.6-8 8v56zm504-486H120c-4.4 0-8 3.6-8 8v56c0 4.4 3.6 8 8 8h784c4.4 0 8-3.6 8-8v-56c0-4.4-3.6-8-8-8zm0 632H120c-4.4 0-8 3.6-8 8v56c0 4.4 3.6 8 8 8h784c4.4 0 8-3.6 8-8v-56c0-4.4-3.6-8-8-8zM115.4 518.9L271.7 642c5.8 4.6 14.4.5 14.4-6.9V388.9c0-7.4-8.5-11.5-14.4-6.9L115.4 505.1a8.74 8.74 0 0 0 0 13.8z"/>
    </svg>
  </symbol>
  <symbol id="svg-menu" viewBox="0 0 24 24">
    <title>Menu</title>
    <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24" fill="none" stroke="currentColor"
      stroke-width="2" stroke-linecap="round" stroke-linejoin="round" class="feather-menu">
      <line x1="3" y1="12" x2="21" y2="12"></line>
      <line x1="3" y1="6" x2="21" y2="6"></line>
      <line x1="3" y1="18" x2="21" y2="18"></line>
    </svg>
  </symbol>
  <symbol id="svg-arrow-right" viewBox="0 0 24 24">
    <title>Expand</title>
    <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24" fill="none" stroke="currentColor"
      stroke-width="2" stroke-linecap="round" stroke-linejoin="round" class="feather-chevron-right">
      <polyline points="9 18 15 12 9 6"></polyline>
    </svg>
  </symbol>
  <symbol id="svg-sun" viewBox="0 0 24 24">
    <title>Light mode</title>
    <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24" fill="none" stroke="currentColor"
      stroke-width="1" stroke-linecap="round" stroke-linejoin="round" class="feather-sun">
      <circle cx="12" cy="12" r="5"></circle>
      <line x1="12" y1="1" x2="12" y2="3"></line>
      <line x1="12" y1="21" x2="12" y2="23"></line>
      <line x1="4.22" y1="4.22" x2="5.64" y2="5.64"></line>
      <line x1="18.36" y1="18.36" x2="19.78" y2="19.78"></line>
      <line x1="1" y1="12" x2="3" y2="12"></line>
      <line x1="21" y1="12" x2="23" y2="12"></line>
      <line x1="4.22" y1="19.78" x2="5.64" y2="18.36"></line>
      <line x1="18.36" y1="5.64" x2="19.78" y2="4.22"></line>
    </svg>
  </symbol>
  <symbol id="svg-moon" viewBox="0 0 24 24">
    <title>Dark mode</title>
    <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24" fill="none" stroke="currentColor"
      stroke-width="1" stroke-linecap="round" stroke-linejoin="round" class="icon-tabler-moon">
      <path stroke="none" d="M0 0h24v24H0z" fill="none" />
      <path d="M12 3c.132 0 .263 0 .393 0a7.5 7.5 0 0 0 7.92 12.446a9 9 0 1 1 -8.313 -12.454z" />
    </svg>
  </symbol>
  <symbol id="svg-sun-with-moon" viewBox="0 0 24 24">
    <title>Auto light/dark, in light mode</title>
    <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24" fill="none" stroke="currentColor"
      stroke-width="1" stroke-linecap="round" stroke-linejoin="round"
      class="icon-custom-derived-from-feather-sun-and-tabler-moon">
      <path style="opacity: 50%" d="M 5.411 14.504 C 5.471 14.504 5.532 14.504 5.591 14.504 C 3.639 16.319 4.383 19.569 6.931 20.352 C 7.693 20.586 8.512 20.551 9.25 20.252 C 8.023 23.207 4.056 23.725 2.11 21.184 C 0.166 18.642 1.702 14.949 4.874 14.536 C 5.051 14.512 5.231 14.5 5.411 14.5 L 5.411 14.504 Z"/>
      <line x1="14.5" y1="3.25" x2="14.5" y2="1.25"/>
      <line x1="14.5" y1="15.85" x2="14.5" y2="17.85"/>
      <line x1="10.044" y1="5.094" x2="8.63" y2="3.68"/>
      <line x1="19" y1="14.05" x2="20.414" y2="15.464"/>
      <line x1="8.2" y1="9.55" x2="6.2" y2="9.55"/>
      <line x1="20.8" y1="9.55" x2="22.8" y2="9.55"/>
      <line x1="10.044" y1="14.006" x2="8.63" y2="15.42"/>
      <line x1="19" y1="5.05" x2="20.414" y2="3.636"/>
      <circle cx="14.5" cy="9.55" r="3.6"/>
    </svg>
  </symbol>
  <symbol id="svg-moon-with-sun" viewBox="0 0 24 24">
    <title>Auto light/dark, in dark mode</title>
    <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24" fill="none" stroke="currentColor"
      stroke-width="1" stroke-linecap="round" stroke-linejoin="round"
      class="icon-custom-derived-from-feather-sun-and-tabler-moon">
      <path d="M 8.282 7.007 C 8.385 7.007 8.494 7.007 8.595 7.007 C 5.18 10.184 6.481 15.869 10.942 17.24 C 12.275 17.648 13.706 17.589 15 17.066 C 12.851 22.236 5.91 23.143 2.505 18.696 C -0.897 14.249 1.791 7.786 7.342 7.063 C 7.652 7.021 7.965 7 8.282 7 L 8.282 7.007 Z"/>
      <line style="opacity: 50%" x1="18" y1="3.705" x2="18" y2="2.5"/>
      <line style="opacity: 50%" x1="18" y1="11.295" x2="18" y2="12.5"/>
      <line style="opacity: 50%" x1="15.316" y1="4.816" x2="14.464" y2="3.964"/>
      <line style="opacity: 50%" x1="20.711" y1="10.212" x2="21.563" y2="11.063"/>
      <line style="opacity: 50%" x1="14.205" y1="7.5" x2="13.001" y2="7.5"/>
      <line style="opacity: 50%" x1="21.795" y1="7.5" x2="23" y2="7.5"/>
      <line style="opacity: 50%" x1="15.316" y1="10.184" x2="14.464" y2="11.036"/>
      <line style="opacity: 50%" x1="20.711" y1="4.789" x2="21.563" y2="3.937"/>
      <circle style="opacity: 50%" cx="18" cy="7.5" r="2.169"/>
    </svg>
  </symbol>
  <symbol id="svg-pencil" viewBox="0 0 24 24">
    <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24" fill="none" stroke="currentColor"
      stroke-width="1" stroke-linecap="round" stroke-linejoin="round" class="icon-tabler-pencil-code">
      <path d="M4 20h4l10.5 -10.5a2.828 2.828 0 1 0 -4 -4l-10.5 10.5v4" />
      <path d="M13.5 6.5l4 4" />
      <path d="M20 21l2 -2l-2 -2" />
      <path d="M17 17l-2 2l2 2" />
    </svg>
  </symbol>
  <symbol id="svg-eye" viewBox="0 0 24 24">
    <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24" fill="none" stroke="currentColor"
      stroke-width="1" stroke-linecap="round" stroke-linejoin="round" class="icon-tabler-eye-code">
      <path stroke="none" d="M0 0h24v24H0z" fill="none" />
      <path d="M10 12a2 2 0 1 0 4 0a2 2 0 0 0 -4 0" />
      <path
        d="M11.11 17.958c-3.209 -.307 -5.91 -2.293 -8.11 -5.958c2.4 -4 5.4 -6 9 -6c3.6 0 6.6 2 9 6c-.21 .352 -.427 .688 -.647 1.008" />
      <path d="M20 21l2 -2l-2 -2" />
      <path d="M17 17l-2 2l2 2" />
    </svg>
  </symbol>
</svg>

<input type="checkbox" class="sidebar-toggle" name="__navigation" id="__navigation">
<input type="checkbox" class="sidebar-toggle" name="__toc" id="__toc">
<label class="overlay sidebar-overlay" for="__navigation">
  <div class="visually-hidden">Hide navigation sidebar</div>
</label>
<label class="overlay toc-overlay" for="__toc">
  <div class="visually-hidden">Hide table of contents sidebar</div>
</label>

<a class="skip-to-content muted-link" href="#furo-main-content">Skip to content</a>



<div class="page">
  <header class="mobile-header">
    <div class="header-left">
      <label class="nav-overlay-icon" for="__navigation">
        <div class="visually-hidden">Toggle site navigation sidebar</div>
        <i class="icon"><svg><use href="#svg-menu"></use></svg></i>
      </label>
    </div>
    <div class="header-center">
      <a href="../index.html"><div class="brand">SPDL 0.1.5 documentation</div></a>
    </div>
    <div class="header-right">
      <div class="theme-toggle-container theme-toggle-header">
        <button class="theme-toggle">
          <div class="visually-hidden">Toggle Light / Dark / Auto color theme</div>
          <svg class="theme-icon-when-auto-light"><use href="#svg-sun-with-moon"></use></svg>
          <svg class="theme-icon-when-auto-dark"><use href="#svg-moon-with-sun"></use></svg>
          <svg class="theme-icon-when-dark"><use href="#svg-moon"></use></svg>
          <svg class="theme-icon-when-light"><use href="#svg-sun"></use></svg>
        </button>
      </div>
      <label class="toc-overlay-icon toc-header-icon" for="__toc">
        <div class="visually-hidden">Toggle table of contents sidebar</div>
        <i class="icon"><svg><use href="#svg-toc"></use></svg></i>
      </label>
    </div>
  </header>
  <aside class="sidebar-drawer">
    <div class="sidebar-container">
      
      <div class="sidebar-sticky"><a class="sidebar-brand" href="../index.html">
  
  
  <span class="sidebar-brand-text">SPDL 0.1.5 documentation</span>
  
</a><form class="sidebar-search-container" method="get" action="../search.html" role="search">
  <input class="sidebar-search" placeholder="Search" name="q" aria-label="Search">
  <input type="hidden" name="check_keywords" value="yes">
  <input type="hidden" name="area" value="default">
</form>
<div id="searchbox"></div><div class="sidebar-scroll"><div class="sidebar-tree">
  <ul>
<li class="toctree-l1"><a class="reference internal" href="../index.html">Home</a></li>
</ul>
<p class="caption" role="heading"><span class="caption-text">Contents</span></p>
<ul class="current">
<li class="toctree-l1"><a class="reference internal" href="../overview.html">Overview</a></li>
<li class="toctree-l1"><a class="reference internal" href="../installation.html">Installation</a></li>
<li class="toctree-l1 has-children"><a class="reference internal" href="../getting_started/index.html">Getting Started</a><input class="toctree-checkbox" id="toctree-checkbox-1" name="toctree-checkbox-1" role="switch" type="checkbox"/><label for="toctree-checkbox-1"><div class="visually-hidden">Toggle navigation of Getting Started</div><i class="icon"><svg><use href="#svg-arrow-right"></use></svg></i></label><ul>
<li class="toctree-l2"><a class="reference internal" href="../getting_started/intro.html">Building and Running Pipeline</a></li>
<li class="toctree-l2"><a class="reference internal" href="../getting_started/stages.html">Pipeline Stages</a></li>
<li class="toctree-l2"><a class="reference internal" href="../getting_started/concurrency.html">Concurrency</a></li>
<li class="toctree-l2"><a class="reference internal" href="../getting_started/parallelism.html">Pipeline Parallelism</a></li>
<li class="toctree-l2"><a class="reference internal" href="../getting_started/logging.html">Collecting Runtime Statistics</a></li>
</ul>
</li>
<li class="toctree-l1 has-children"><a class="reference internal" href="../async/index.html">Introduction to Async I/O</a><input class="toctree-checkbox" id="toctree-checkbox-2" name="toctree-checkbox-2" role="switch" type="checkbox"/><label for="toctree-checkbox-2"><div class="visually-hidden">Toggle navigation of Introduction to Async I/O</div><i class="icon"><svg><use href="#svg-arrow-right"></use></svg></i></label><ul>
<li class="toctree-l2"><a class="reference internal" href="../async/problem.html">Implementing Orchestration Mechanism</a></li>
<li class="toctree-l2"><a class="reference internal" href="../async/event_loop.html">The Event Loop</a></li>
<li class="toctree-l2"><a class="reference internal" href="../async/unit.html">The <code class="docutils literal notranslate"><span class="pre">async</span></code> and <code class="docutils literal notranslate"><span class="pre">await</span></code> keywords</a></li>
<li class="toctree-l2"><a class="reference internal" href="../async/sync.html">Running Synchronous Functions</a></li>
</ul>
</li>
<li class="toctree-l1 has-children"><a class="reference internal" href="../optimization_guide/index.html">Optimization Guide</a><input class="toctree-checkbox" id="toctree-checkbox-3" name="toctree-checkbox-3" role="switch" type="checkbox"/><label for="toctree-checkbox-3"><div class="visually-hidden">Toggle navigation of Optimization Guide</div><i class="icon"><svg><use href="#svg-arrow-right"></use></svg></i></label><ul>
<li class="toctree-l2"><a class="reference internal" href="../optimization_guide/headspace_analysis.html">Headspace Analysis</a></li>
<li class="toctree-l2"><a class="reference internal" href="../optimization_guide/noisy_neighbour.html">Noisy Neighbour</a></li>
<li class="toctree-l2"><a class="reference internal" href="../optimization_guide/setup.html">Composition of Pipeline</a></li>
<li class="toctree-l2"><a class="reference internal" href="../optimization_guide/analysis.html">Analyzing the Performance</a></li>
<li class="toctree-l2"><a class="reference internal" href="../optimization_guide/fleet_metrics.html">Metrics across Ranks</a></li>
<li class="toctree-l2"><a class="reference internal" href="../optimization_guide/straggler.html">The Straggler</a></li>
<li class="toctree-l2"><a class="reference internal" href="../optimization_guide/resolution.html">Resolving the Bottleneck</a></li>
</ul>
</li>
<li class="toctree-l1 has-children"><a class="reference internal" href="../case_studies/index.html">Case Studies</a><input class="toctree-checkbox" id="toctree-checkbox-4" name="toctree-checkbox-4" role="switch" type="checkbox"/><label for="toctree-checkbox-4"><div class="visually-hidden">Toggle navigation of Case Studies</div><i class="icon"><svg><use href="#svg-arrow-right"></use></svg></i></label><ul>
<li class="toctree-l2"><a class="reference internal" href="../case_studies/parallelism.html">Parallelism and Performance</a></li>
<li class="toctree-l2"><a class="reference internal" href="../case_studies/data_format.html">Data Format and Performance</a></li>
<li class="toctree-l2"><a class="reference internal" href="../case_studies/inference.html">Building Inference Pipeline</a></li>
</ul>
</li>
<li class="toctree-l1 has-children"><a class="reference internal" href="../migration/index.html">Migration Guide</a><input class="toctree-checkbox" id="toctree-checkbox-5" name="toctree-checkbox-5" role="switch" type="checkbox"/><label for="toctree-checkbox-5"><div class="visually-hidden">Toggle navigation of Migration Guide</div><i class="icon"><svg><use href="#svg-arrow-right"></use></svg></i></label><ul>
<li class="toctree-l2"><a class="reference internal" href="../migration/why.html">Why migrate to SPDL?</a></li>
<li class="toctree-l2"><a class="reference internal" href="../migration/paradigm_shift.html">Paradigm Shift</a></li>
<li class="toctree-l2"><a class="reference internal" href="../migration/pytorch.html">Migrating from PyTorch DataLoader</a></li>
</ul>
</li>
<li class="toctree-l1"><a class="reference internal" href="../best_practice.html">Best Practices</a></li>
<li class="toctree-l1 current has-children"><a class="reference internal" href="../examples.html">Examples</a><input checked="" class="toctree-checkbox" id="toctree-checkbox-6" name="toctree-checkbox-6" role="switch" type="checkbox"/><label for="toctree-checkbox-6"><div class="visually-hidden">Toggle navigation of Examples</div><i class="icon"><svg><use href="#svg-arrow-right"></use></svg></i></label><ul class="current">
<li class="toctree-l2"><a class="reference internal" href="image_dataloading.html">Image dataloading</a></li>
<li class="toctree-l2"><a class="reference internal" href="video_dataloading.html">Video dataloading</a></li>
<li class="toctree-l2"><a class="reference internal" href="imagenet_classification.html">Imagenet classification</a></li>
<li class="toctree-l2"><a class="reference internal" href="multi_thread_preprocessing.html">Multi thread preprocessing</a></li>
<li class="toctree-l2"><a class="reference internal" href="streaming_nvdec_decoding.html">Streaming nvdec decoding</a></li>
<li class="toctree-l2"><a class="reference internal" href="streaming_video_processing.html">Streaming video processing</a></li>
<li class="toctree-l2"><a class="reference internal" href="performance_analysis.html">Performance analysis</a></li>
<li class="toctree-l2"><a class="reference internal" href="data_formats.html">Data formats</a></li>
<li class="toctree-l2"><a class="reference internal" href="hydra_integration.html">Hydra integration</a></li>
<li class="toctree-l2"><a class="reference internal" href="pipeline_definitions.html">Pipeline definitions</a></li>
<li class="toctree-l2"><a class="reference internal" href="pipeline_profiling.html">Pipeline profiling</a></li>
<li class="toctree-l2 current current-page"><a class="current reference internal" href="#">Benchmark wav</a></li>
<li class="toctree-l2"><a class="reference internal" href="benchmark_tarfile.html">Benchmark tarfile</a></li>
</ul>
</li>
<li class="toctree-l1"><a class="reference internal" href="../faq.html">Frequently Asked Questions</a></li>
</ul>
<p class="caption" role="heading"><span class="caption-text">API References</span></p>
<ul>
<li class="toctree-l1 has-children"><a class="reference internal" href="../api.html">API Reference</a><input class="toctree-checkbox" id="toctree-checkbox-7" name="toctree-checkbox-7" role="switch" type="checkbox"/><label for="toctree-checkbox-7"><div class="visually-hidden">Toggle navigation of API Reference</div><i class="icon"><svg><use href="#svg-arrow-right"></use></svg></i></label><ul>
<li class="toctree-l2"><a class="reference internal" href="spdl.pipeline.html">spdl.pipeline</a></li>
<li class="toctree-l2"><a class="reference internal" href="spdl.pipeline.defs.html">spdl.pipeline.defs</a></li>
<li class="toctree-l2"><a class="reference internal" href="spdl.dataloader.html">spdl.dataloader</a></li>
<li class="toctree-l2"><a class="reference internal" href="spdl.source.html">spdl.source</a></li>
<li class="toctree-l2"><a class="reference internal" href="spdl.io.html">spdl.io</a></li>
<li class="toctree-l2"><a class="reference internal" href="spdl.io.utils.html">spdl.io.utils</a></li>
</ul>
</li>
<li class="toctree-l1 has-children"><a class="reference internal" href="../cpp.html">API Reference (C++)</a><input class="toctree-checkbox" id="toctree-checkbox-8" name="toctree-checkbox-8" role="switch" type="checkbox"/><label for="toctree-checkbox-8"><div class="visually-hidden">Toggle navigation of API Reference (C++)</div><i class="icon"><svg><use href="#svg-arrow-right"></use></svg></i></label><ul>
<li class="toctree-l2"><a class="reference internal" href="libspdl/libspdl_class.html">Class List</a></li>
<li class="toctree-l2"><a class="reference internal" href="libspdl/libspdl_file.html">File List</a></li>
<li class="toctree-l2 has-children"><a class="reference internal" href="libspdl/libspdl_api.html">API</a><input class="toctree-checkbox" id="toctree-checkbox-9" name="toctree-checkbox-9" role="switch" type="checkbox"/><label for="toctree-checkbox-9"><div class="visually-hidden">Toggle navigation of API</div><i class="icon"><svg><use href="#svg-arrow-right"></use></svg></i></label><ul>
<li class="toctree-l3"><a class="reference internal" href="libspdl/namespace_spdl.html">Namespace spdl</a></li>
<li class="toctree-l3"><a class="reference internal" href="libspdl/namespace_spdl__core.html">Namespace spdl::core</a></li>
<li class="toctree-l3"><a class="reference internal" href="libspdl/namespace_spdl__core__detail.html">Namespace spdl::core::detail</a></li>
<li class="toctree-l3"><a class="reference internal" href="libspdl/namespace_std.html">Namespace std</a></li>
<li class="toctree-l3"><a class="reference internal" href="libspdl/structAVRational.html">Struct AVRational</a></li>
<li class="toctree-l3"><a class="reference internal" href="libspdl/structspdl_1_1core_1_1BytesAdaptor.html">Struct BytesAdaptor</a></li>
<li class="toctree-l3"><a class="reference internal" href="libspdl/structspdl_1_1core_1_1CPUBuffer.html">Struct CPUBuffer</a></li>
<li class="toctree-l3"><a class="reference internal" href="libspdl/structspdl_1_1core_1_1DataInterface.html">Struct DataInterface</a></li>
<li class="toctree-l3"><a class="reference internal" href="libspdl/structspdl_1_1core_1_1DecodeConfig.html">Struct DecodeConfig</a></li>
<li class="toctree-l3"><a class="reference internal" href="libspdl/structspdl_1_1core_1_1DemuxConfig.html">Struct DemuxConfig</a></li>
<li class="toctree-l3"><a class="reference internal" href="libspdl/structspdl_1_1core_1_1EncodeConfigBase.html">Template Struct EncodeConfigBase</a></li>
<li class="toctree-l3"><a class="reference internal" href="libspdl/structspdl_1_1core_1_1Generator.html">Template Struct Generator</a></li>
<li class="toctree-l3"><a class="reference internal" href="libspdl/structspdl_1_1core_1_1Generator_1_1promise__type.html">Struct Generator::promise_type</a></li>
<li class="toctree-l3"><a class="reference internal" href="libspdl/structspdl_1_1core_1_1Packets.html">Template Struct Packets</a></li>
<li class="toctree-l3"><a class="reference internal" href="libspdl/structspdl_1_1core_1_1RawPacketData.html">Struct RawPacketData</a></li>
<li class="toctree-l3"><a class="reference internal" href="libspdl/structspdl_1_1core_1_1SourceAdaptor.html">Struct SourceAdaptor</a></li>
<li class="toctree-l3"><a class="reference internal" href="libspdl/structspdl_1_1core_1_1Storage.html">Struct Storage</a></li>
<li class="toctree-l3"><a class="reference internal" href="libspdl/classspdl_1_1core_1_1BSF.html">Template Class BSF</a></li>
<li class="toctree-l3"><a class="reference internal" href="libspdl/classspdl_1_1core_1_1Codec.html">Template Class Codec</a></li>
<li class="toctree-l3"><a class="reference internal" href="libspdl/classspdl_1_1core_1_1CPUStorage.html">Class CPUStorage</a></li>
<li class="toctree-l3"><a class="reference internal" href="libspdl/classspdl_1_1core_1_1Decoder.html">Template Class Decoder</a></li>
<li class="toctree-l3"><a class="reference internal" href="libspdl/classspdl_1_1core_1_1Demuxer.html">Class Demuxer</a></li>
<li class="toctree-l3"><a class="reference internal" href="libspdl/classspdl_1_1core_1_1detail_1_1DecoderImpl.html">Template Class DecoderImpl</a></li>
<li class="toctree-l3"><a class="reference internal" href="libspdl/classspdl_1_1core_1_1detail_1_1EncoderImpl.html">Template Class EncoderImpl</a></li>
<li class="toctree-l3"><a class="reference internal" href="libspdl/classspdl_1_1core_1_1Encoder.html">Template Class Encoder</a></li>
<li class="toctree-l3"><a class="reference internal" href="libspdl/classspdl_1_1core_1_1FilterGraph.html">Class FilterGraph</a></li>
<li class="toctree-l3"><a class="reference internal" href="libspdl/classspdl_1_1core_1_1Frames.html">Template Class Frames</a></li>
<li class="toctree-l3"><a class="reference internal" href="libspdl/classspdl_1_1core_1_1InternalError.html">Class InternalError</a></li>
<li class="toctree-l3"><a class="reference internal" href="libspdl/classspdl_1_1core_1_1Muxer.html">Class Muxer</a></li>
<li class="toctree-l3"><a class="reference internal" href="libspdl/classspdl_1_1core_1_1PacketSeries.html">Class PacketSeries</a></li>
<li class="toctree-l3"><a class="reference internal" href="libspdl/classspdl_1_1core_1_1StreamingDemuxer.html">Class StreamingDemuxer</a></li>
<li class="toctree-l3"><a class="reference internal" href="libspdl/classspdl_1_1core_1_1TracingSession.html">Class TracingSession</a></li>
<li class="toctree-l3"><a class="reference internal" href="libspdl/enum_types_8h_1a5422694500d2203e301dc182e5f63d22.html">Enum CodecID</a></li>
<li class="toctree-l3"><a class="reference internal" href="libspdl/enum_types_8h_1adb4e1adb2b3a59148c2797f903ead06f.html">Enum ElemClass</a></li>
<li class="toctree-l3"><a class="reference internal" href="libspdl/enum_types_8h_1ac22438cfd069f0b1b6a736e73e8d244c.html">Enum MediaType</a></li>
<li class="toctree-l3"><a class="reference internal" href="libspdl/function_frames_8h_1a30fbfab5f9ecfb208928ebdaca7f4349.html">Template Function spdl::core::clone</a></li>
<li class="toctree-l3"><a class="reference internal" href="libspdl/function_conversion_8h_1a3f08ca7a5c09ab82603e239e50dff4d7.html">Template Function spdl::core::convert_frames(const std::vector&lt;const Frames&lt;media&gt; *&gt;&amp;, std::shared_ptr&lt;CPUStorage&gt;)</a></li>
<li class="toctree-l3"><a class="reference internal" href="libspdl/function_conversion_8h_1ae55bfac2f391205603d77241fc25ca1a.html">Template Function spdl::core::convert_frames(const Frames&lt;media&gt; *, std::shared_ptr&lt;CPUStorage&gt;)</a></li>
<li class="toctree-l3"><a class="reference internal" href="libspdl/function_buffer_8h_1abb668d9a68635211e5e07bd5038df4aa.html">Function spdl::core::cpu_buffer</a></li>
<li class="toctree-l3"><a class="reference internal" href="libspdl/function_conversion_8h_1a295b42ad20d2569806d9a15009a44ca8.html">Function spdl::core::create_reference_audio_frame</a></li>
<li class="toctree-l3"><a class="reference internal" href="libspdl/function_conversion_8h_1a87d61e0429716c42f3a5f5e85aad5b61.html">Function spdl::core::create_reference_video_frame</a></li>
<li class="toctree-l3"><a class="reference internal" href="libspdl/function_packets_8h_1ad3bdea22ad439f82174ce27c26bec857.html">Function spdl::core::extract_packets_at_indices</a></li>
<li class="toctree-l3"><a class="reference internal" href="libspdl/function_utils_8h_1a0aef7b410dcb4075e477b10ba3e71f80.html">Function spdl::core::get_ffmpeg_filters</a></li>
<li class="toctree-l3"><a class="reference internal" href="libspdl/function_utils_8h_1ae1a3d30b33d837c39c40190e681d37c8.html">Function spdl::core::get_ffmpeg_log_level</a></li>
<li class="toctree-l3"><a class="reference internal" href="libspdl/function_utils_8h_1a0ebae69b46f68552c3f64ddc2af67f53.html">Function spdl::core::get_ffmpeg_versions</a></li>
<li class="toctree-l3"><a class="reference internal" href="libspdl/function_packets_8h_1a50ec9c8a7e6ab71e7827df2eb862dc40.html">Template Function spdl::core::get_timestamps</a></li>
<li class="toctree-l3"><a class="reference internal" href="libspdl/function_utils_8h_1af82c781c7484afbad6cbac32ff925793.html">Function spdl::core::init_glog</a></li>
<li class="toctree-l3"><a class="reference internal" href="libspdl/function_utils_8h_1abbebef003881d8734c12e03a47814732.html">Function spdl::core::init_tracing</a></li>
<li class="toctree-l3"><a class="reference internal" href="libspdl/function_demuxing_8h_1ad3fdb02bd04d231cd7238e034c27711f.html">Function spdl::core::make_demuxer(const std::string&amp;, const SourceAdaptorPtr&amp;, const std::optional&lt;DemuxConfig&gt;&amp;)</a></li>
<li class="toctree-l3"><a class="reference internal" href="libspdl/function_demuxing_8h_1a590baa95f8eeb6bc0092c723ff060dd4.html">Function spdl::core::make_demuxer(const std::string_view, const std::optional&lt;DemuxConfig&gt;&amp;)</a></li>
<li class="toctree-l3"><a class="reference internal" href="libspdl/function_filter__graph_8h_1aaa3dba3ab905bd429d038f0bbaa6ce16.html">Function spdl::core::make_filter_graph</a></li>
<li class="toctree-l3"><a class="reference internal" href="libspdl/function_utils_8h_1aa1e91130e5d71e8c2a104e4f72296ff3.html">Function spdl::core::register_avdevices</a></li>
<li class="toctree-l3"><a class="reference internal" href="libspdl/function_utils_8h_1a9b6c16227a1a8445319b487cacb0cd1d.html">Function spdl::core::set_ffmpeg_log_level</a></li>
<li class="toctree-l3"><a class="reference internal" href="libspdl/function_utils_8h_1a893d39670b4169063d8f6e3723f4bc11.html">Template Function spdl::core::trace_counter</a></li>
<li class="toctree-l3"><a class="reference internal" href="libspdl/function_utils_8h_1ae27a1cc3e5bfd9997090eb40711cc6c6.html">Function spdl::core::trace_event_begin</a></li>
<li class="toctree-l3"><a class="reference internal" href="libspdl/function_utils_8h_1a8f29c25b417b77e9dfb5a769b418c169.html">Function spdl::core::trace_event_end</a></li>
<li class="toctree-l3"><a class="reference internal" href="libspdl/define_frames_8h_1ac2ad95ac922a100ec27340436eb94940.html">Define _IS_AUDIO</a></li>
<li class="toctree-l3"><a class="reference internal" href="libspdl/define_frames_8h_1ac99c83df576500933a3691deb137be6d.html">Define _IS_IMAGE</a></li>
<li class="toctree-l3"><a class="reference internal" href="libspdl/define_frames_8h_1a9beaa64113e413112d43491ba5c13670.html">Define _IS_VIDEO</a></li>
<li class="toctree-l3"><a class="reference internal" href="libspdl/define_types_8h_1a3a6c4d7f842d451acf8717ce734385f2.html">Define SPDL_DEFAULT_BUFFER_SIZE</a></li>
<li class="toctree-l3"><a class="reference internal" href="libspdl/typedef_types_8h_1a6eff035c271caa5a533987a1e00ad43e.html">Typedef AVRational</a></li>
<li class="toctree-l3"><a class="reference internal" href="libspdl/typedef_frames_8h_1aba3a9982b74abb6be181dc4d247d53fa.html">Typedef spdl::core::AnyFrames</a></li>
<li class="toctree-l3"><a class="reference internal" href="libspdl/typedef_packets_8h_1ab96da01bb9cc9793e8ae2637e1dd610b.html">Typedef spdl::core::AnyPackets</a></li>
<li class="toctree-l3"><a class="reference internal" href="libspdl/typedef_codec_8h_1a9098e05b01da4afd02090b0d6d7624ba.html">Typedef spdl::core::AudioCodec</a></li>
<li class="toctree-l3"><a class="reference internal" href="libspdl/typedef_types_8h_1a23b168da4cdf96923387b92a43f20038.html">Typedef spdl::core::AudioEncodeConfig</a></li>
<li class="toctree-l3"><a class="reference internal" href="libspdl/typedef_encoder_8h_1a57216492ce017017647dba9d1f6f2a5d.html">Typedef spdl::core::AudioEncoder</a></li>
<li class="toctree-l3"><a class="reference internal" href="libspdl/typedef_encoder_8h_1a0dfcc06d4bbea67c7f45399be8719fa6.html">Typedef spdl::core::AudioEncoderPtr</a></li>
<li class="toctree-l3"><a class="reference internal" href="libspdl/typedef_frames_8h_1a5be56dffe8f2b76de9540fb1ad8b83bf.html">Typedef spdl::core::AudioFrames</a></li>
<li class="toctree-l3"><a class="reference internal" href="libspdl/typedef_frames_8h_1a9db8234daca15eb073d00fa762641b62.html">Typedef spdl::core::AudioFramesPtr</a></li>
<li class="toctree-l3"><a class="reference internal" href="libspdl/typedef_packets_8h_1a9644f8aa13f0e4db02d8ab60673563a3.html">Typedef spdl::core::AudioPackets</a></li>
<li class="toctree-l3"><a class="reference internal" href="libspdl/typedef_packets_8h_1ab2cc72fb6b931466960bd4b9f812784c.html">Typedef spdl::core::AudioPacketsPtr</a></li>
<li class="toctree-l3"><a class="reference internal" href="libspdl/typedef_buffer_8h_1ab6e5b43497adbd35e9fbc35cf5be7101.html">Typedef spdl::core::CPUBufferPtr</a></li>
<li class="toctree-l3"><a class="reference internal" href="libspdl/typedef_adaptor_8h_1adcb670a31326eb24268b384396736cd6.html">Typedef spdl::core::DataInterfacePtr</a></li>
<li class="toctree-l3"><a class="reference internal" href="libspdl/typedef_decoder_8h_1a4b0502ea20d1dda958a67deeb582a74b.html">Typedef spdl::core::DecoderPtr</a></li>
<li class="toctree-l3"><a class="reference internal" href="libspdl/typedef_demuxing_8h_1a4b53016f9b756cc2c2cfbd0e5ad9558b.html">Typedef spdl::core::DemuxerPtr</a></li>
<li class="toctree-l3"><a class="reference internal" href="libspdl/typedef_encoder_8h_1aacfba556b86e2d663a004b8677567339.html">Typedef spdl::core::EncoderPtr</a></li>
<li class="toctree-l3"><a class="reference internal" href="libspdl/typedef_filter__graph_8h_1a29554b40f89e4b227521ff86ccf69b8b.html">Typedef spdl::core::FilterGraphPtr</a></li>
<li class="toctree-l3"><a class="reference internal" href="libspdl/typedef_frames_8h_1ad628496b3863230dd76eeccc4fa66437.html">Typedef spdl::core::FramesPtr</a></li>
<li class="toctree-l3"><a class="reference internal" href="libspdl/typedef_codec_8h_1a606d432c7b033a787f653c4992937e6f.html">Typedef spdl::core::ImageCodec</a></li>
<li class="toctree-l3"><a class="reference internal" href="libspdl/typedef_frames_8h_1a53a3c93ef56a4400fabd3a553ab21c4a.html">Typedef spdl::core::ImageFrames</a></li>
<li class="toctree-l3"><a class="reference internal" href="libspdl/typedef_frames_8h_1a3760130bba382ba7f15df177ca3374c7.html">Typedef spdl::core::ImageFramesPtr</a></li>
<li class="toctree-l3"><a class="reference internal" href="libspdl/typedef_packets_8h_1af018ade1cd38831c342686abbcb787a8.html">Typedef spdl::core::ImagePackets</a></li>
<li class="toctree-l3"><a class="reference internal" href="libspdl/typedef_packets_8h_1a8b9c8b08fcbf891fa939700ecd807ce1.html">Typedef spdl::core::ImagePacketsPtr</a></li>
<li class="toctree-l3"><a class="reference internal" href="libspdl/typedef_muxer_8h_1aaa76352d246819df02bc407729f69dda.html">Typedef spdl::core::MuxerPtr</a></li>
<li class="toctree-l3"><a class="reference internal" href="libspdl/typedef_types_8h_1aa5d8175da6bbcbe93e7191461f7baa20.html">Typedef spdl::core::OptionDict</a></li>
<li class="toctree-l3"><a class="reference internal" href="libspdl/typedef_packets_8h_1a331b599d0eceb00ebef166d64623c71a.html">Typedef spdl::core::PacketSeriesPtr</a></li>
<li class="toctree-l3"><a class="reference internal" href="libspdl/typedef_packets_8h_1aad5761fe07714efccc2be969a4397354.html">Typedef spdl::core::PacketsPtr</a></li>
<li class="toctree-l3"><a class="reference internal" href="libspdl/typedef_types_8h_1a8bd80c8465b1f3e17b564c5ced977a2d.html">Typedef spdl::core::Rational</a></li>
<li class="toctree-l3"><a class="reference internal" href="libspdl/typedef_adaptor_8h_1adfe58c3c3a3d3171c1d69c2e9924f2a7.html">Typedef spdl::core::SourceAdaptorPtr</a></li>
<li class="toctree-l3"><a class="reference internal" href="libspdl/typedef_demuxing_8h_1a0a7f8c140cd7110dc5f3f6537fae67db.html">Typedef spdl::core::StreamingDemuxerPtr</a></li>
<li class="toctree-l3"><a class="reference internal" href="libspdl/typedef_codec_8h_1ac7441badce2b2aa467eac09b35d4f81e.html">Typedef spdl::core::VideoCodec</a></li>
<li class="toctree-l3"><a class="reference internal" href="libspdl/typedef_types_8h_1a8b310bdb98714a971b07aa58f7403529.html">Typedef spdl::core::VideoEncodeConfig</a></li>
<li class="toctree-l3"><a class="reference internal" href="libspdl/typedef_encoder_8h_1a383bf2b0ac1564702f10e3b5f3ef03f6.html">Typedef spdl::core::VideoEncoder</a></li>
<li class="toctree-l3"><a class="reference internal" href="libspdl/typedef_encoder_8h_1a39ace4ea741767fa3d802040a9bc22e1.html">Typedef spdl::core::VideoEncoderPtr</a></li>
<li class="toctree-l3"><a class="reference internal" href="libspdl/typedef_frames_8h_1af1892953097f3723455403752ef79fc5.html">Typedef spdl::core::VideoFrames</a></li>
<li class="toctree-l3"><a class="reference internal" href="libspdl/typedef_frames_8h_1acb0efeb222082bf955c71c74964d301d.html">Typedef spdl::core::VideoFramesPtr</a></li>
<li class="toctree-l3"><a class="reference internal" href="libspdl/typedef_packets_8h_1a7be7c9faccc623d12fb33ec966f84b4c.html">Typedef spdl::core::VideoPackets</a></li>
<li class="toctree-l3"><a class="reference internal" href="libspdl/typedef_packets_8h_1aa21b44d594bfc132b4252fd2f544a691.html">Typedef spdl::core::VideoPacketsPtr</a></li>
</ul>
</li>
</ul>
</li>
<li class="toctree-l1"><a class="reference internal" href="../genindex.html">API Index</a></li>
</ul>
<p class="caption" role="heading"><span class="caption-text">Development Notes</span></p>
<ul>
<li class="toctree-l1 has-children"><a class="reference internal" href="../notes/index.html">Development Notes</a><input class="toctree-checkbox" id="toctree-checkbox-10" name="toctree-checkbox-10" role="switch" type="checkbox"/><label for="toctree-checkbox-10"><div class="visually-hidden">Toggle navigation of Development Notes</div><i class="icon"><svg><use href="#svg-arrow-right"></use></svg></i></label><ul>
<li class="toctree-l2"><a class="reference internal" href="../notes/pipeline_impl.html">Implementation detail of Pipeline</a></li>
</ul>
</li>
</ul>

</div>
</div>
<div class="sidebar-tree">
<ul>
  <li class="toctree-l1 has-children">
    <span class="reference">Versions</span>
    <input class="toctree-checkbox" id="toctree-checkbox-versions" name="toctree-checkbox-versions" role="switch" type="checkbox">
    <label for="toctree-checkbox-versions">
      <div class="visually-hidden">Toggle navigattion of Versions</div>
      <i class="icon">
        <svg>
          <use href="#svg-arrow-right"></use>
        </svg>
      </i>
    </label>
    <ul>
      <li class="toctree-l2"><a class="reference internal" href="/spdl/main">dev</a></li>
      <li class="toctree-l2"><a class="reference internal" href="/spdl/latest">latest-release</a></li>
      <li class="toctree-l2"><a class="reference internal" href="/spdl/main">0.1.5</a></li>
      <li class="toctree-l2"><a class="reference internal" href="/spdl/0.1.4">0.1.4</a></li>
      <li class="toctree-l2"><a class="reference internal" href="/spdl/0.1.3">0.1.3</a></li>
      <li class="toctree-l2"><a class="reference internal" href="/spdl/0.1.2">0.1.2</a></li>
      <li class="toctree-l2"><a class="reference internal" href="/spdl/0.1.1">0.1.1</a></li>
      <li class="toctree-l2"><a class="reference internal" href="/spdl/0.1.0">0.1.0</a></li>
      <li class="toctree-l2"><a class="reference internal" href="/spdl/0.0.14">0.0.14</a></li>
      <li class="toctree-l2"><a class="reference internal" href="/spdl/0.0.13">0.0.13</a></li>
      <li class="toctree-l2"><a class="reference internal" href="/spdl/0.0.12">0.0.12</a></li>
      <li class="toctree-l2"><a class="reference internal" href="/spdl/0.0.11">0.0.11</a></li>
      <li class="toctree-l2"><a class="reference internal" href="/spdl/0.0.10">0.0.10</a></li>
      <li class="toctree-l2"><a class="reference internal" href="/spdl/0.0.9">0.0.9</a></li>
      <li class="toctree-l2"><a class="reference internal" href="/spdl/0.0.8">0.0.8</a></li>
    </ul>
  </li>
</ul>
</div>
      </div>
      
    </div>
  </aside>
  <div class="main">
    <div class="content">
      <div class="article-container">
        <a href="#" class="back-to-top muted-link">
          <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24">
            <path d="M13 20h-2V8l-5.5 5.5-1.42-1.42L12 4.16l7.92 7.92-1.42 1.42L13 8v12z"></path>
          </svg>
          <span>Back to top</span>
        </a>
        <div class="content-icon-container">
          <div class="view-this-page">
  <a class="muted-link" href="../_sources/generated/benchmark_wav.rst.txt" title="View this page">
    <svg><use href="#svg-eye"></use></svg>
    <span class="visually-hidden">View this page</span>
  </a>
</div>
<div class="theme-toggle-container theme-toggle-content">
            <button class="theme-toggle">
              <div class="visually-hidden">Toggle Light / Dark / Auto color theme</div>
              <svg class="theme-icon-when-auto-light"><use href="#svg-sun-with-moon"></use></svg>
              <svg class="theme-icon-when-auto-dark"><use href="#svg-moon-with-sun"></use></svg>
              <svg class="theme-icon-when-dark"><use href="#svg-moon"></use></svg>
              <svg class="theme-icon-when-light"><use href="#svg-sun"></use></svg>
            </button>
          </div>
          <label class="toc-overlay-icon toc-content-icon" for="__toc">
            <div class="visually-hidden">Toggle table of contents sidebar</div>
            <i class="icon"><svg><use href="#svg-toc"></use></svg></i>
          </label>
        </div>
        <article role="main" id="furo-main-content">
          <div class="custom_autosummary"><section id="module-benchmark_wav">
<span id="benchmark-wav"></span><span id="example-benchmark-wav"></span><h1>Benchmark wav<a class="headerlink" href="#module-benchmark_wav" title="Link to this heading">¶</a></h1>
<p>This example measuers the performance of loading WAV audio.</p>
<p>It compares three different approaches for loading WAV files:</p>
<ul class="simple">
<li><p><a class="reference internal" href="spdl.io.load_wav.html#spdl.io.load_wav" title="spdl.io.load_wav"><code class="xref py py-func docutils literal notranslate"><span class="pre">spdl.io.load_wav()</span></code></a>: Fast native WAV parser optimized for simple PCM formats</p></li>
<li><p><a class="reference internal" href="spdl.io.load_audio.html#spdl.io.load_audio" title="spdl.io.load_audio"><code class="xref py py-func docutils literal notranslate"><span class="pre">spdl.io.load_audio()</span></code></a>: General-purpose audio loader using FFmpeg backend</p></li>
<li><p><code class="docutils literal notranslate"><span class="pre">soundfile</span></code> (<code class="docutils literal notranslate"><span class="pre">libsndfile</span></code>): Popular third-party audio I/O library</p></li>
</ul>
<p>The benchmark suite evaluates performance across multiple dimensions:</p>
<ul class="simple">
<li><p>Various audio configurations (sample rates, channels, bit depths, durations)</p></li>
<li><p>Different thread counts (1, 2, 4, 8, 16) to measure parallel scaling</p></li>
<li><p>Statistical analysis with 95% confidence intervals using Student’s t-distribution</p></li>
<li><p>Queries per second (QPS) as the primary performance metric</p></li>
</ul>
<p><strong>Example</strong></p>
<div class="highlight-shell notranslate"><div class="highlight"><pre><span></span>$<span class="w"> </span>python<span class="w"> </span>benchmark_wav.py<span class="w"> </span>--plot<span class="w"> </span>--output<span class="w"> </span>results.png
</pre></div>
</div>
<p><strong>Result</strong></p>
<p>The following plot shows the QPS (measured by the number of files processed) of each
functions with different audio durations.</p>
<img alt="../_static/data/example-benchmark-wav.webp" src="../_static/data/example-benchmark-wav.webp" />
<p>The <a class="reference internal" href="spdl.io.load_wav.html#spdl.io.load_wav" title="spdl.io.load_wav"><code class="xref py py-func docutils literal notranslate"><span class="pre">spdl.io.load_wav()</span></code></a> is a lot faster than the others, because all it
does is reinterpret the input byte string as array.
It shows the same performance for audio with longer duration.</p>
<p>And since parsing WAV is instant, the spdl.io.load_wav function spends more time on
creation of NumPy Array.
It needs to acquire the GIL, thus the performance does not scale in multi-threading.
(This performance pattern of this function is pretty same as the
<span class="xref std std-ref">spdl.io.load_npz</span>.)</p>
<p>The following is the same plot without <code class="docutils literal notranslate"><span class="pre">load_wav</span></code>.</p>
<img alt="../_static/data/example-benchmark-wav-2.webp" src="../_static/data/example-benchmark-wav-2.webp" />
<p><code class="docutils literal notranslate"><span class="pre">libsoundfile</span></code> has to process data iteratively (using <code class="docutils literal notranslate"><span class="pre">io.BytesIO</span></code>) because
it does not support directly loading from byte string, so it takes longer to process
longer audio data.
The performance trend (single thread being the fastest) suggests that
it does not release the GIL majority of the time.</p>
<p>The <a class="reference internal" href="spdl.io.load_audio.html#spdl.io.load_audio" title="spdl.io.load_audio"><code class="xref py py-func docutils literal notranslate"><span class="pre">spdl.io.load_audio()</span></code></a> function (the generic FFmpeg-based implementation) does
a lot of work so its overall performance is not as good,
but it scales in multi-threading as it releases the GIL almost entirely.</p>
<section id="source">
<h2>Source<a class="headerlink" href="#source" title="Link to this heading">¶</a></h2>
<p class="rubric">Source</p>
<details>
<summary><u>Click here to see the source.</u></summary><div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="linenos">  1</span><span class="c1"># Copyright (c) Meta Platforms, Inc. and affiliates.</span>
<span class="linenos">  2</span><span class="c1"># All rights reserved.</span>
<span class="linenos">  3</span><span class="c1">#</span>
<span class="linenos">  4</span><span class="c1"># This source code is licensed under the BSD-style license found in the</span>
<span class="linenos">  5</span><span class="c1"># LICENSE file in the root directory of this source tree.</span>
<span class="linenos">  6</span>
<span class="linenos">  7</span><span class="c1"># pyre-strict</span>
<span class="linenos">  8</span>
<span class="linenos">  9</span><span class="sd">&quot;&quot;&quot;This example measuers the performance of loading WAV audio.</span>
<span class="linenos"> 10</span>
<span class="linenos"> 11</span><span class="sd">It compares three different approaches for loading WAV files:</span>
<span class="linenos"> 12</span>
<span class="linenos"> 13</span><span class="sd">- :py:func:`spdl.io.load_wav`: Fast native WAV parser optimized for simple PCM formats</span>
<span class="linenos"> 14</span><span class="sd">- :py:func:`spdl.io.load_audio`: General-purpose audio loader using FFmpeg backend</span>
<span class="linenos"> 15</span><span class="sd">- ``soundfile`` (``libsndfile``): Popular third-party audio I/O library</span>
<span class="linenos"> 16</span>
<span class="linenos"> 17</span><span class="sd">The benchmark suite evaluates performance across multiple dimensions:</span>
<span class="linenos"> 18</span>
<span class="linenos"> 19</span><span class="sd">- Various audio configurations (sample rates, channels, bit depths, durations)</span>
<span class="linenos"> 20</span><span class="sd">- Different thread counts (1, 2, 4, 8, 16) to measure parallel scaling</span>
<span class="linenos"> 21</span><span class="sd">- Statistical analysis with 95% confidence intervals using Student&#39;s t-distribution</span>
<span class="linenos"> 22</span><span class="sd">- Queries per second (QPS) as the primary performance metric</span>
<span class="linenos"> 23</span>
<span class="linenos"> 24</span><span class="sd">**Example**</span>
<span class="linenos"> 25</span>
<span class="linenos"> 26</span><span class="sd">.. code-block:: shell</span>
<span class="linenos"> 27</span>
<span class="linenos"> 28</span><span class="sd">   $ python benchmark_wav.py --plot --output results.png</span>
<span class="linenos"> 29</span>
<span class="linenos"> 30</span><span class="sd">**Result**</span>
<span class="linenos"> 31</span>
<span class="linenos"> 32</span><span class="sd">The following plot shows the QPS (measured by the number of files processed) of each</span>
<span class="linenos"> 33</span><span class="sd">functions with different audio durations.</span>
<span class="linenos"> 34</span>
<span class="linenos"> 35</span><span class="sd">.. image:: ../../_static/data/example-benchmark-wav.webp</span>
<span class="linenos"> 36</span>
<span class="linenos"> 37</span>
<span class="linenos"> 38</span><span class="sd">The :py:func:`spdl.io.load_wav` is a lot faster than the others, because all it</span>
<span class="linenos"> 39</span><span class="sd">does is reinterpret the input byte string as array.</span>
<span class="linenos"> 40</span><span class="sd">It shows the same performance for audio with longer duration.</span>
<span class="linenos"> 41</span>
<span class="linenos"> 42</span><span class="sd">And since parsing WAV is instant, the spdl.io.load_wav function spends more time on</span>
<span class="linenos"> 43</span><span class="sd">creation of NumPy Array.</span>
<span class="linenos"> 44</span><span class="sd">It needs to acquire the GIL, thus the performance does not scale in multi-threading.</span>
<span class="linenos"> 45</span><span class="sd">(This performance pattern of this function is pretty same as the</span>
<span class="linenos"> 46</span><span class="sd">:ref:`spdl.io.load_npz &lt;data-format&gt;`.)</span>
<span class="linenos"> 47</span>
<span class="linenos"> 48</span><span class="sd">The following is the same plot without ``load_wav``.</span>
<span class="linenos"> 49</span>
<span class="linenos"> 50</span><span class="sd">.. image:: ../../_static/data/example-benchmark-wav-2.webp</span>
<span class="linenos"> 51</span>
<span class="linenos"> 52</span><span class="sd">``libsoundfile`` has to process data iteratively (using ``io.BytesIO``) because</span>
<span class="linenos"> 53</span><span class="sd">it does not support directly loading from byte string, so it takes longer to process</span>
<span class="linenos"> 54</span><span class="sd">longer audio data.</span>
<span class="linenos"> 55</span><span class="sd">The performance trend (single thread being the fastest) suggests that</span>
<span class="linenos"> 56</span><span class="sd">it does not release the GIL majority of the time.</span>
<span class="linenos"> 57</span>
<span class="linenos"> 58</span><span class="sd">The :py:func:`spdl.io.load_audio` function (the generic FFmpeg-based implementation) does</span>
<span class="linenos"> 59</span><span class="sd">a lot of work so its overall performance is not as good,</span>
<span class="linenos"> 60</span><span class="sd">but it scales in multi-threading as it releases the GIL almost entirely.</span>
<span class="linenos"> 61</span><span class="sd">&quot;&quot;&quot;</span>
<span class="linenos"> 62</span>
<span class="linenos"> 63</span><span class="n">__all__</span> <span class="o">=</span> <span class="p">[</span>
<span class="linenos"> 64</span>    <span class="s2">&quot;BenchmarkResult&quot;</span><span class="p">,</span>
<span class="linenos"> 65</span>    <span class="s2">&quot;BenchmarkConfig&quot;</span><span class="p">,</span>
<span class="linenos"> 66</span>    <span class="s2">&quot;create_wav_data&quot;</span><span class="p">,</span>
<span class="linenos"> 67</span>    <span class="s2">&quot;load_sf&quot;</span><span class="p">,</span>
<span class="linenos"> 68</span>    <span class="s2">&quot;load_spdl_audio&quot;</span><span class="p">,</span>
<span class="linenos"> 69</span>    <span class="s2">&quot;load_spdl_wav&quot;</span><span class="p">,</span>
<span class="linenos"> 70</span>    <span class="s2">&quot;benchmark&quot;</span><span class="p">,</span>
<span class="linenos"> 71</span>    <span class="s2">&quot;run_benchmark_suite&quot;</span><span class="p">,</span>
<span class="linenos"> 72</span>    <span class="s2">&quot;plot_benchmark_results&quot;</span><span class="p">,</span>
<span class="linenos"> 73</span>    <span class="s2">&quot;main&quot;</span><span class="p">,</span>
<span class="linenos"> 74</span><span class="p">]</span>
<span class="linenos"> 75</span>
<span class="linenos"> 76</span><span class="kn">import</span><span class="w"> </span><span class="nn">argparse</span>
<span class="linenos"> 77</span><span class="kn">import</span><span class="w"> </span><span class="nn">io</span>
<span class="linenos"> 78</span><span class="kn">import</span><span class="w"> </span><span class="nn">os.path</span>
<span class="linenos"> 79</span><span class="kn">import</span><span class="w"> </span><span class="nn">time</span>
<span class="linenos"> 80</span><span class="kn">from</span><span class="w"> </span><span class="nn">collections.abc</span><span class="w"> </span><span class="kn">import</span> <span class="n">Callable</span>
<span class="linenos"> 81</span><span class="kn">from</span><span class="w"> </span><span class="nn">concurrent.futures</span><span class="w"> </span><span class="kn">import</span> <span class="n">as_completed</span><span class="p">,</span> <span class="n">ThreadPoolExecutor</span>
<span class="linenos"> 82</span><span class="kn">from</span><span class="w"> </span><span class="nn">dataclasses</span><span class="w"> </span><span class="kn">import</span> <span class="n">dataclass</span>
<span class="linenos"> 83</span>
<span class="linenos"> 84</span><span class="kn">import</span><span class="w"> </span><span class="nn">numpy</span><span class="w"> </span><span class="k">as</span><span class="w"> </span><span class="nn">np</span>
<span class="linenos"> 85</span><span class="kn">import</span><span class="w"> </span><span class="nn">scipy.io.wavfile</span>
<span class="linenos"> 86</span><span class="kn">import</span><span class="w"> </span><span class="nn">scipy.stats</span>
<span class="linenos"> 87</span><span class="kn">import</span><span class="w"> </span><span class="nn">soundfile</span><span class="w"> </span><span class="k">as</span><span class="w"> </span><span class="nn">sf</span>
<span class="linenos"> 88</span><span class="kn">import</span><span class="w"> </span><span class="nn">spdl.io</span>
<span class="linenos"> 89</span><span class="kn">from</span><span class="w"> </span><span class="nn">numpy.typing</span><span class="w"> </span><span class="kn">import</span> <span class="n">NDArray</span>
<span class="linenos"> 90</span>
<span class="linenos"> 91</span>
<span class="linenos"> 92</span><span class="k">def</span><span class="w"> </span><span class="nf">create_wav_data</span><span class="p">(</span>
<span class="linenos"> 93</span>    <span class="n">sample_rate</span><span class="p">:</span> <span class="nb">int</span> <span class="o">=</span> <span class="mi">44100</span><span class="p">,</span>
<span class="linenos"> 94</span>    <span class="n">num_channels</span><span class="p">:</span> <span class="nb">int</span> <span class="o">=</span> <span class="mi">2</span><span class="p">,</span>
<span class="linenos"> 95</span>    <span class="n">bits_per_sample</span><span class="p">:</span> <span class="nb">int</span> <span class="o">=</span> <span class="mi">16</span><span class="p">,</span>
<span class="linenos"> 96</span>    <span class="n">duration_seconds</span><span class="p">:</span> <span class="nb">float</span> <span class="o">=</span> <span class="mf">1.0</span><span class="p">,</span>
<span class="linenos"> 97</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="nb">tuple</span><span class="p">[</span><span class="nb">bytes</span><span class="p">,</span> <span class="n">NDArray</span><span class="p">]:</span>
<span class="linenos"> 98</span><span class="w">    </span><span class="sd">&quot;&quot;&quot;Create a WAV file in memory for benchmarking.</span>
<span class="linenos"> 99</span>
<span class="linenos">100</span><span class="sd">    Args:</span>
<span class="linenos">101</span><span class="sd">        sample_rate: Sample rate in Hz</span>
<span class="linenos">102</span><span class="sd">        num_channels: Number of audio channels</span>
<span class="linenos">103</span><span class="sd">        bits_per_sample: Bits per sample (16 or 32)</span>
<span class="linenos">104</span><span class="sd">        duration_seconds: Duration of audio in seconds</span>
<span class="linenos">105</span>
<span class="linenos">106</span><span class="sd">    Returns:</span>
<span class="linenos">107</span><span class="sd">        Tuple of (WAV file as bytes, audio samples array)</span>
<span class="linenos">108</span><span class="sd">    &quot;&quot;&quot;</span>
<span class="linenos">109</span>    <span class="n">num_samples</span> <span class="o">=</span> <span class="nb">int</span><span class="p">(</span><span class="n">sample_rate</span> <span class="o">*</span> <span class="n">duration_seconds</span><span class="p">)</span>
<span class="linenos">110</span>
<span class="linenos">111</span>    <span class="n">dtype_map</span> <span class="o">=</span> <span class="p">{</span>
<span class="linenos">112</span>        <span class="mi">16</span><span class="p">:</span> <span class="n">np</span><span class="o">.</span><span class="n">int16</span><span class="p">,</span>
<span class="linenos">113</span>        <span class="mi">32</span><span class="p">:</span> <span class="n">np</span><span class="o">.</span><span class="n">int32</span><span class="p">,</span>
<span class="linenos">114</span>    <span class="p">}</span>
<span class="linenos">115</span>    <span class="n">dtype</span> <span class="o">=</span> <span class="n">dtype_map</span><span class="p">[</span><span class="n">bits_per_sample</span><span class="p">]</span>
<span class="linenos">116</span>    <span class="n">max_amplitude</span> <span class="o">=</span> <span class="mi">32767</span> <span class="k">if</span> <span class="n">bits_per_sample</span> <span class="o">==</span> <span class="mi">16</span> <span class="k">else</span> <span class="mi">2147483647</span>
<span class="linenos">117</span>
<span class="linenos">118</span>    <span class="n">t</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">linspace</span><span class="p">(</span><span class="mi">0</span><span class="p">,</span> <span class="n">duration_seconds</span><span class="p">,</span> <span class="n">num_samples</span><span class="p">)</span>
<span class="linenos">119</span>    <span class="n">frequencies</span> <span class="o">=</span> <span class="mf">440.0</span> <span class="o">+</span> <span class="n">np</span><span class="o">.</span><span class="n">arange</span><span class="p">(</span><span class="n">num_channels</span><span class="p">)</span> <span class="o">*</span> <span class="mf">110.0</span>
<span class="linenos">120</span>    <span class="n">sine_waves</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">sin</span><span class="p">(</span><span class="mi">2</span> <span class="o">*</span> <span class="n">np</span><span class="o">.</span><span class="n">pi</span> <span class="o">*</span> <span class="n">frequencies</span><span class="p">[:,</span> <span class="n">np</span><span class="o">.</span><span class="n">newaxis</span><span class="p">]</span> <span class="o">*</span> <span class="n">t</span><span class="p">)</span>
<span class="linenos">121</span>    <span class="n">samples</span> <span class="o">=</span> <span class="p">(</span><span class="n">sine_waves</span><span class="o">.</span><span class="n">T</span> <span class="o">*</span> <span class="n">max_amplitude</span><span class="p">)</span><span class="o">.</span><span class="n">astype</span><span class="p">(</span><span class="n">dtype</span><span class="p">)</span>
<span class="linenos">122</span>
<span class="linenos">123</span>    <span class="n">wav_buffer</span> <span class="o">=</span> <span class="n">io</span><span class="o">.</span><span class="n">BytesIO</span><span class="p">()</span>
<span class="linenos">124</span>    <span class="n">scipy</span><span class="o">.</span><span class="n">io</span><span class="o">.</span><span class="n">wavfile</span><span class="o">.</span><span class="n">write</span><span class="p">(</span><span class="n">wav_buffer</span><span class="p">,</span> <span class="n">sample_rate</span><span class="p">,</span> <span class="n">samples</span><span class="p">)</span>
<span class="linenos">125</span>    <span class="n">wav_data</span> <span class="o">=</span> <span class="n">wav_buffer</span><span class="o">.</span><span class="n">getvalue</span><span class="p">()</span>
<span class="linenos">126</span>
<span class="linenos">127</span>    <span class="k">return</span> <span class="n">wav_data</span><span class="p">,</span> <span class="n">samples</span>
<span class="linenos">128</span>
<span class="linenos">129</span>
<span class="linenos">130</span><span class="k">def</span><span class="w"> </span><span class="nf">load_sf</span><span class="p">(</span><span class="n">wav_data</span><span class="p">:</span> <span class="nb">bytes</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="n">NDArray</span><span class="p">:</span>
<span class="linenos">131</span><span class="w">    </span><span class="sd">&quot;&quot;&quot;Load WAV data using soundfile library.</span>
<span class="linenos">132</span>
<span class="linenos">133</span><span class="sd">    Args:</span>
<span class="linenos">134</span><span class="sd">        wav_data: WAV file data as bytes</span>
<span class="linenos">135</span>
<span class="linenos">136</span><span class="sd">    Returns:</span>
<span class="linenos">137</span><span class="sd">        Audio samples array as int16 numpy array</span>
<span class="linenos">138</span><span class="sd">    &quot;&quot;&quot;</span>
<span class="linenos">139</span>    <span class="n">audio_file</span> <span class="o">=</span> <span class="n">io</span><span class="o">.</span><span class="n">BytesIO</span><span class="p">(</span><span class="n">wav_data</span><span class="p">)</span>
<span class="linenos">140</span>    <span class="n">data</span><span class="p">,</span> <span class="n">_</span> <span class="o">=</span> <span class="n">sf</span><span class="o">.</span><span class="n">read</span><span class="p">(</span><span class="n">audio_file</span><span class="p">,</span> <span class="n">dtype</span><span class="o">=</span><span class="s2">&quot;int16&quot;</span><span class="p">)</span>
<span class="linenos">141</span>    <span class="k">return</span> <span class="n">data</span>
<span class="linenos">142</span>
<span class="linenos">143</span>
<span class="linenos">144</span><span class="k">def</span><span class="w"> </span><span class="nf">load_spdl_audio</span><span class="p">(</span><span class="n">wav_data</span><span class="p">:</span> <span class="nb">bytes</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="n">NDArray</span><span class="p">:</span>
<span class="linenos">145</span><span class="w">    </span><span class="sd">&quot;&quot;&quot;Load WAV data using :py:func:`spdl.io.load_audio` function.</span>
<span class="linenos">146</span>
<span class="linenos">147</span><span class="sd">    Args:</span>
<span class="linenos">148</span><span class="sd">        wav_data: WAV file data as bytes</span>
<span class="linenos">149</span>
<span class="linenos">150</span><span class="sd">    Returns:</span>
<span class="linenos">151</span><span class="sd">        Audio samples array as numpy array</span>
<span class="linenos">152</span><span class="sd">    &quot;&quot;&quot;</span>
<span class="linenos">153</span>    <span class="k">return</span> <span class="n">spdl</span><span class="o">.</span><span class="n">io</span><span class="o">.</span><span class="n">to_numpy</span><span class="p">(</span><span class="n">spdl</span><span class="o">.</span><span class="n">io</span><span class="o">.</span><span class="n">load_audio</span><span class="p">(</span><span class="n">wav_data</span><span class="p">,</span> <span class="n">filter_desc</span><span class="o">=</span><span class="kc">None</span><span class="p">))</span>
<span class="linenos">154</span>
<span class="linenos">155</span>
<span class="linenos">156</span><span class="k">def</span><span class="w"> </span><span class="nf">load_spdl_wav</span><span class="p">(</span><span class="n">wav_data</span><span class="p">:</span> <span class="nb">bytes</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="n">NDArray</span><span class="p">:</span>
<span class="linenos">157</span><span class="w">    </span><span class="sd">&quot;&quot;&quot;Load WAV data using :py:func:`spdl.io.load_wav` function.</span>
<span class="linenos">158</span>
<span class="linenos">159</span><span class="sd">    Args:</span>
<span class="linenos">160</span><span class="sd">        wav_data: WAV file data as bytes</span>
<span class="linenos">161</span>
<span class="linenos">162</span><span class="sd">    Returns:</span>
<span class="linenos">163</span><span class="sd">        Audio samples array as numpy array</span>
<span class="linenos">164</span><span class="sd">    &quot;&quot;&quot;</span>
<span class="linenos">165</span>    <span class="k">return</span> <span class="n">spdl</span><span class="o">.</span><span class="n">io</span><span class="o">.</span><span class="n">to_numpy</span><span class="p">(</span><span class="n">spdl</span><span class="o">.</span><span class="n">io</span><span class="o">.</span><span class="n">load_wav</span><span class="p">(</span><span class="n">wav_data</span><span class="p">))</span>
<span class="linenos">166</span>
<span class="linenos">167</span>
<span class="linenos">168</span><span class="nd">@dataclass</span><span class="p">(</span><span class="n">frozen</span><span class="o">=</span><span class="kc">True</span><span class="p">)</span>
<span class="linenos">169</span><span class="k">class</span><span class="w"> </span><span class="nc">BenchmarkResult</span><span class="p">:</span>
<span class="linenos">170</span><span class="w">    </span><span class="sd">&quot;&quot;&quot;Results from a single benchmark run.&quot;&quot;&quot;</span>
<span class="linenos">171</span>
<span class="linenos">172</span>    <span class="n">duration</span><span class="p">:</span> <span class="nb">float</span>
<span class="linenos">173</span>    <span class="n">qps</span><span class="p">:</span> <span class="nb">float</span>
<span class="linenos">174</span>    <span class="n">ci_lower</span><span class="p">:</span> <span class="nb">float</span>
<span class="linenos">175</span>    <span class="n">ci_upper</span><span class="p">:</span> <span class="nb">float</span>
<span class="linenos">176</span>    <span class="n">num_threads</span><span class="p">:</span> <span class="nb">int</span>
<span class="linenos">177</span>    <span class="n">function_name</span><span class="p">:</span> <span class="nb">str</span>
<span class="linenos">178</span>    <span class="n">duration_seconds</span><span class="p">:</span> <span class="nb">float</span>
<span class="linenos">179</span>
<span class="linenos">180</span>
<span class="linenos">181</span><span class="k">def</span><span class="w"> </span><span class="nf">benchmark</span><span class="p">(</span>
<span class="linenos">182</span>    <span class="n">name</span><span class="p">:</span> <span class="nb">str</span><span class="p">,</span>
<span class="linenos">183</span>    <span class="n">func</span><span class="p">:</span> <span class="n">Callable</span><span class="p">[[],</span> <span class="n">NDArray</span><span class="p">],</span>
<span class="linenos">184</span>    <span class="n">iterations</span><span class="p">:</span> <span class="nb">int</span><span class="p">,</span>
<span class="linenos">185</span>    <span class="n">num_threads</span><span class="p">:</span> <span class="nb">int</span><span class="p">,</span>
<span class="linenos">186</span>    <span class="n">num_sets</span><span class="p">:</span> <span class="nb">int</span><span class="p">,</span>
<span class="linenos">187</span>    <span class="n">duration_seconds</span><span class="p">:</span> <span class="nb">float</span><span class="p">,</span>
<span class="linenos">188</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="nb">tuple</span><span class="p">[</span><span class="n">BenchmarkResult</span><span class="p">,</span> <span class="n">NDArray</span><span class="p">]:</span>
<span class="linenos">189</span><span class="w">    </span><span class="sd">&quot;&quot;&quot;Benchmark a function using multiple threads and calculate statistics.</span>
<span class="linenos">190</span>
<span class="linenos">191</span><span class="sd">    Executes a warmup phase followed by multiple benchmark sets to compute</span>
<span class="linenos">192</span><span class="sd">    performance metrics including mean queries per second (QPS) and 95%</span>
<span class="linenos">193</span><span class="sd">    confidence intervals using Student&#39;s t-distribution.</span>
<span class="linenos">194</span>
<span class="linenos">195</span><span class="sd">    Args:</span>
<span class="linenos">196</span><span class="sd">        name: Descriptive name for the benchmark (used in results)</span>
<span class="linenos">197</span><span class="sd">        func: Callable function to benchmark (takes no args, returns NDArray)</span>
<span class="linenos">198</span><span class="sd">        iterations: Total number of function calls per benchmark set</span>
<span class="linenos">199</span><span class="sd">        num_threads: Number of concurrent threads for parallel execution</span>
<span class="linenos">200</span><span class="sd">        num_sets: Number of independent benchmark sets for confidence interval</span>
<span class="linenos">201</span><span class="sd">        duration_seconds: Duration of audio file being processed (for metadata)</span>
<span class="linenos">202</span>
<span class="linenos">203</span><span class="sd">    Returns:</span>
<span class="linenos">204</span><span class="sd">        Tuple containing:</span>
<span class="linenos">205</span><span class="sd">            - BenchmarkResult with timing statistics, QPS, confidence intervals</span>
<span class="linenos">206</span><span class="sd">            - Output NDArray from the last function execution</span>
<span class="linenos">207</span><span class="sd">    &quot;&quot;&quot;</span>
<span class="linenos">208</span>
<span class="linenos">209</span>    <span class="k">with</span> <span class="n">ThreadPoolExecutor</span><span class="p">(</span><span class="n">max_workers</span><span class="o">=</span><span class="n">num_threads</span><span class="p">)</span> <span class="k">as</span> <span class="n">executor</span><span class="p">:</span>
<span class="linenos">210</span>        <span class="c1"># Warmup</span>
<span class="linenos">211</span>        <span class="n">futures</span> <span class="o">=</span> <span class="p">[</span><span class="n">executor</span><span class="o">.</span><span class="n">submit</span><span class="p">(</span><span class="n">func</span><span class="p">)</span> <span class="k">for</span> <span class="n">_</span> <span class="ow">in</span> <span class="nb">range</span><span class="p">(</span><span class="n">num_threads</span> <span class="o">*</span> <span class="mi">30</span><span class="p">)]</span>
<span class="linenos">212</span>        <span class="k">for</span> <span class="n">future</span> <span class="ow">in</span> <span class="n">as_completed</span><span class="p">(</span><span class="n">futures</span><span class="p">):</span>
<span class="linenos">213</span>            <span class="n">output</span> <span class="o">=</span> <span class="n">future</span><span class="o">.</span><span class="n">result</span><span class="p">()</span>
<span class="linenos">214</span>
<span class="linenos">215</span>        <span class="c1"># Run multiple sets for confidence interval</span>
<span class="linenos">216</span>        <span class="n">qps_samples</span> <span class="o">=</span> <span class="p">[]</span>
<span class="linenos">217</span>        <span class="k">for</span> <span class="n">_</span> <span class="ow">in</span> <span class="nb">range</span><span class="p">(</span><span class="n">num_sets</span><span class="p">):</span>
<span class="linenos">218</span>            <span class="n">t0</span> <span class="o">=</span> <span class="n">time</span><span class="o">.</span><span class="n">perf_counter</span><span class="p">()</span>
<span class="linenos">219</span>            <span class="n">futures</span> <span class="o">=</span> <span class="p">[</span><span class="n">executor</span><span class="o">.</span><span class="n">submit</span><span class="p">(</span><span class="n">func</span><span class="p">)</span> <span class="k">for</span> <span class="n">_</span> <span class="ow">in</span> <span class="nb">range</span><span class="p">(</span><span class="n">iterations</span><span class="p">)]</span>
<span class="linenos">220</span>            <span class="k">for</span> <span class="n">future</span> <span class="ow">in</span> <span class="n">as_completed</span><span class="p">(</span><span class="n">futures</span><span class="p">):</span>
<span class="linenos">221</span>                <span class="n">output</span> <span class="o">=</span> <span class="n">future</span><span class="o">.</span><span class="n">result</span><span class="p">()</span>
<span class="linenos">222</span>            <span class="n">elapsed</span> <span class="o">=</span> <span class="n">time</span><span class="o">.</span><span class="n">perf_counter</span><span class="p">()</span> <span class="o">-</span> <span class="n">t0</span>
<span class="linenos">223</span>            <span class="n">qps_samples</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="n">iterations</span> <span class="o">/</span> <span class="n">elapsed</span><span class="p">)</span>
<span class="linenos">224</span>
<span class="linenos">225</span>    <span class="c1"># Calculate mean and 95% confidence interval</span>
<span class="linenos">226</span>    <span class="n">qps_mean</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">mean</span><span class="p">(</span><span class="n">qps_samples</span><span class="p">)</span>
<span class="linenos">227</span>    <span class="n">qps_std</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">std</span><span class="p">(</span><span class="n">qps_samples</span><span class="p">,</span> <span class="n">ddof</span><span class="o">=</span><span class="mi">1</span><span class="p">)</span>
<span class="linenos">228</span>    <span class="n">confidence_level</span> <span class="o">=</span> <span class="mf">0.95</span>
<span class="linenos">229</span>    <span class="n">degrees_freedom</span> <span class="o">=</span> <span class="n">num_sets</span> <span class="o">-</span> <span class="mi">1</span>
<span class="linenos">230</span>    <span class="n">confidence_interval</span> <span class="o">=</span> <span class="n">scipy</span><span class="o">.</span><span class="n">stats</span><span class="o">.</span><span class="n">t</span><span class="o">.</span><span class="n">interval</span><span class="p">(</span>
<span class="linenos">231</span>        <span class="n">confidence_level</span><span class="p">,</span>
<span class="linenos">232</span>        <span class="n">degrees_freedom</span><span class="p">,</span>
<span class="linenos">233</span>        <span class="n">loc</span><span class="o">=</span><span class="n">qps_mean</span><span class="p">,</span>
<span class="linenos">234</span>        <span class="n">scale</span><span class="o">=</span><span class="n">qps_std</span> <span class="o">/</span> <span class="n">np</span><span class="o">.</span><span class="n">sqrt</span><span class="p">(</span><span class="n">num_sets</span><span class="p">),</span>
<span class="linenos">235</span>    <span class="p">)</span>
<span class="linenos">236</span>
<span class="linenos">237</span>    <span class="n">duration</span> <span class="o">=</span> <span class="mf">1.0</span> <span class="o">/</span> <span class="n">qps_mean</span>
<span class="linenos">238</span>    <span class="n">result</span> <span class="o">=</span> <span class="n">BenchmarkResult</span><span class="p">(</span>
<span class="linenos">239</span>        <span class="n">duration</span><span class="o">=</span><span class="n">duration</span><span class="p">,</span>
<span class="linenos">240</span>        <span class="n">qps</span><span class="o">=</span><span class="n">qps_mean</span><span class="p">,</span>
<span class="linenos">241</span>        <span class="n">ci_lower</span><span class="o">=</span><span class="nb">float</span><span class="p">(</span><span class="n">confidence_interval</span><span class="p">[</span><span class="mi">0</span><span class="p">]),</span>
<span class="linenos">242</span>        <span class="n">ci_upper</span><span class="o">=</span><span class="nb">float</span><span class="p">(</span><span class="n">confidence_interval</span><span class="p">[</span><span class="mi">1</span><span class="p">]),</span>
<span class="linenos">243</span>        <span class="n">num_threads</span><span class="o">=</span><span class="n">num_threads</span><span class="p">,</span>
<span class="linenos">244</span>        <span class="n">function_name</span><span class="o">=</span><span class="n">name</span><span class="p">,</span>
<span class="linenos">245</span>        <span class="n">duration_seconds</span><span class="o">=</span><span class="n">duration_seconds</span><span class="p">,</span>
<span class="linenos">246</span>    <span class="p">)</span>
<span class="linenos">247</span>    <span class="k">return</span> <span class="n">result</span><span class="p">,</span> <span class="n">output</span>  <span class="c1"># pyre-ignore[61]</span>
<span class="linenos">248</span>
<span class="linenos">249</span>
<span class="linenos">250</span><span class="k">def</span><span class="w"> </span><span class="nf">run_benchmark_suite</span><span class="p">(</span>
<span class="linenos">251</span>    <span class="n">wav_data</span><span class="p">:</span> <span class="nb">bytes</span><span class="p">,</span>
<span class="linenos">252</span>    <span class="n">ref</span><span class="p">:</span> <span class="n">NDArray</span><span class="p">,</span>
<span class="linenos">253</span>    <span class="n">num_threads</span><span class="p">:</span> <span class="nb">int</span><span class="p">,</span>
<span class="linenos">254</span>    <span class="n">duration_seconds</span><span class="p">:</span> <span class="nb">float</span><span class="p">,</span>
<span class="linenos">255</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="nb">tuple</span><span class="p">[</span><span class="n">BenchmarkResult</span><span class="p">,</span> <span class="n">BenchmarkResult</span><span class="p">,</span> <span class="n">BenchmarkResult</span><span class="p">]:</span>
<span class="linenos">256</span><span class="w">    </span><span class="sd">&quot;&quot;&quot;Run benchmarks for both libraries with given parameters.</span>
<span class="linenos">257</span>
<span class="linenos">258</span><span class="sd">    Args:</span>
<span class="linenos">259</span><span class="sd">        wav_data: WAV file data as bytes</span>
<span class="linenos">260</span><span class="sd">        ref: Reference audio array for validation</span>
<span class="linenos">261</span><span class="sd">        num_threads: Number of threads (use 1 for single-threaded)</span>
<span class="linenos">262</span><span class="sd">        duration_seconds: Duration of audio in seconds</span>
<span class="linenos">263</span>
<span class="linenos">264</span><span class="sd">    Returns:</span>
<span class="linenos">265</span><span class="sd">        Tuple of (spdl_wav_result, spdl_audio_result, soundfile_result)</span>
<span class="linenos">266</span><span class="sd">    &quot;&quot;&quot;</span>
<span class="linenos">267</span>    <span class="c1"># load_wav is fast but the performance is unstable, so we need to run more</span>
<span class="linenos">268</span>    <span class="n">iterations</span> <span class="o">=</span> <span class="mi">100</span> <span class="o">*</span> <span class="n">num_threads</span>
<span class="linenos">269</span>    <span class="n">num_sets</span> <span class="o">=</span> <span class="mi">100</span>
<span class="linenos">270</span>
<span class="linenos">271</span>    <span class="n">spdl_wav_result</span><span class="p">,</span> <span class="n">output</span> <span class="o">=</span> <span class="n">benchmark</span><span class="p">(</span>
<span class="linenos">272</span>        <span class="n">name</span><span class="o">=</span><span class="s2">&quot;spdl.io.load_wav&quot;</span><span class="p">,</span>
<span class="linenos">273</span>        <span class="n">func</span><span class="o">=</span><span class="k">lambda</span><span class="p">:</span> <span class="n">load_spdl_wav</span><span class="p">(</span><span class="n">wav_data</span><span class="p">),</span>
<span class="linenos">274</span>        <span class="n">iterations</span><span class="o">=</span><span class="n">iterations</span><span class="p">,</span>
<span class="linenos">275</span>        <span class="n">num_threads</span><span class="o">=</span><span class="n">num_threads</span><span class="p">,</span>
<span class="linenos">276</span>        <span class="n">num_sets</span><span class="o">=</span><span class="n">num_sets</span><span class="p">,</span>
<span class="linenos">277</span>        <span class="n">duration_seconds</span><span class="o">=</span><span class="n">duration_seconds</span><span class="p">,</span>
<span class="linenos">278</span>    <span class="p">)</span>
<span class="linenos">279</span>    <span class="n">np</span><span class="o">.</span><span class="n">testing</span><span class="o">.</span><span class="n">assert_array_equal</span><span class="p">(</span><span class="n">output</span><span class="p">,</span> <span class="n">ref</span><span class="p">)</span>
<span class="linenos">280</span>
<span class="linenos">281</span>    <span class="c1"># others are slow but the performance is stable.</span>
<span class="linenos">282</span>    <span class="n">iterations</span> <span class="o">=</span> <span class="mi">10</span> <span class="o">*</span> <span class="n">num_threads</span>
<span class="linenos">283</span>    <span class="n">num_sets</span> <span class="o">=</span> <span class="mi">5</span>
<span class="linenos">284</span>
<span class="linenos">285</span>    <span class="n">spdl_audio_result</span><span class="p">,</span> <span class="n">output</span> <span class="o">=</span> <span class="n">benchmark</span><span class="p">(</span>
<span class="linenos">286</span>        <span class="n">name</span><span class="o">=</span><span class="s2">&quot;spdl.io.load_audio&quot;</span><span class="p">,</span>
<span class="linenos">287</span>        <span class="n">func</span><span class="o">=</span><span class="k">lambda</span><span class="p">:</span> <span class="n">load_spdl_audio</span><span class="p">(</span><span class="n">wav_data</span><span class="p">),</span>
<span class="linenos">288</span>        <span class="n">iterations</span><span class="o">=</span><span class="n">iterations</span><span class="p">,</span>
<span class="linenos">289</span>        <span class="n">num_threads</span><span class="o">=</span><span class="n">num_threads</span><span class="p">,</span>
<span class="linenos">290</span>        <span class="n">num_sets</span><span class="o">=</span><span class="n">num_sets</span><span class="p">,</span>
<span class="linenos">291</span>        <span class="n">duration_seconds</span><span class="o">=</span><span class="n">duration_seconds</span><span class="p">,</span>
<span class="linenos">292</span>    <span class="p">)</span>
<span class="linenos">293</span>    <span class="n">np</span><span class="o">.</span><span class="n">testing</span><span class="o">.</span><span class="n">assert_array_equal</span><span class="p">(</span><span class="n">output</span><span class="p">,</span> <span class="n">ref</span><span class="p">)</span>
<span class="linenos">294</span>    <span class="n">soundfile_result</span><span class="p">,</span> <span class="n">output</span> <span class="o">=</span> <span class="n">benchmark</span><span class="p">(</span>
<span class="linenos">295</span>        <span class="n">name</span><span class="o">=</span><span class="s2">&quot;soundfile&quot;</span><span class="p">,</span>
<span class="linenos">296</span>        <span class="n">func</span><span class="o">=</span><span class="k">lambda</span><span class="p">:</span> <span class="n">load_sf</span><span class="p">(</span><span class="n">wav_data</span><span class="p">),</span>
<span class="linenos">297</span>        <span class="n">iterations</span><span class="o">=</span><span class="n">iterations</span><span class="p">,</span>
<span class="linenos">298</span>        <span class="n">num_threads</span><span class="o">=</span><span class="n">num_threads</span><span class="p">,</span>
<span class="linenos">299</span>        <span class="n">num_sets</span><span class="o">=</span><span class="n">num_sets</span><span class="p">,</span>
<span class="linenos">300</span>        <span class="n">duration_seconds</span><span class="o">=</span><span class="n">duration_seconds</span><span class="p">,</span>
<span class="linenos">301</span>    <span class="p">)</span>
<span class="linenos">302</span>    <span class="k">if</span> <span class="n">output</span><span class="o">.</span><span class="n">ndim</span> <span class="o">==</span> <span class="mi">1</span><span class="p">:</span>
<span class="linenos">303</span>        <span class="n">output</span> <span class="o">=</span> <span class="n">output</span><span class="p">[:,</span> <span class="kc">None</span><span class="p">]</span>
<span class="linenos">304</span>    <span class="n">np</span><span class="o">.</span><span class="n">testing</span><span class="o">.</span><span class="n">assert_array_equal</span><span class="p">(</span><span class="n">output</span><span class="p">,</span> <span class="n">ref</span><span class="p">)</span>
<span class="linenos">305</span>
<span class="linenos">306</span>    <span class="k">return</span> <span class="n">spdl_wav_result</span><span class="p">,</span> <span class="n">spdl_audio_result</span><span class="p">,</span> <span class="n">soundfile_result</span>
<span class="linenos">307</span>
<span class="linenos">308</span>
<span class="linenos">309</span><span class="nd">@dataclass</span><span class="p">(</span><span class="n">frozen</span><span class="o">=</span><span class="kc">True</span><span class="p">)</span>
<span class="linenos">310</span><span class="k">class</span><span class="w"> </span><span class="nc">BenchmarkConfig</span><span class="p">:</span>
<span class="linenos">311</span><span class="w">    </span><span class="sd">&quot;&quot;&quot;Configuration for audio file parameters used in benchmarking.</span>
<span class="linenos">312</span>
<span class="linenos">313</span><span class="sd">    Attributes:</span>
<span class="linenos">314</span><span class="sd">        sample_rate: Audio sample rate in Hz (e.g., 44100 for CD quality)</span>
<span class="linenos">315</span><span class="sd">        num_channels: Number of audio channels (1=mono, 2=stereo, etc.)</span>
<span class="linenos">316</span><span class="sd">        bits_per_sample: Bit depth per sample (16 or 32)</span>
<span class="linenos">317</span><span class="sd">        duration_seconds: Duration of the audio file in seconds</span>
<span class="linenos">318</span><span class="sd">    &quot;&quot;&quot;</span>
<span class="linenos">319</span>
<span class="linenos">320</span>    <span class="n">sample_rate</span><span class="p">:</span> <span class="nb">int</span>
<span class="linenos">321</span>    <span class="n">num_channels</span><span class="p">:</span> <span class="nb">int</span>
<span class="linenos">322</span>    <span class="n">bits_per_sample</span><span class="p">:</span> <span class="nb">int</span>
<span class="linenos">323</span>    <span class="n">duration_seconds</span><span class="p">:</span> <span class="nb">float</span>
<span class="linenos">324</span>
<span class="linenos">325</span>
<span class="linenos">326</span><span class="k">def</span><span class="w"> </span><span class="nf">plot_benchmark_results</span><span class="p">(</span>
<span class="linenos">327</span>    <span class="n">results</span><span class="p">:</span> <span class="nb">list</span><span class="p">[</span><span class="n">BenchmarkResult</span><span class="p">],</span> <span class="n">output_file</span><span class="p">:</span> <span class="nb">str</span> <span class="o">=</span> <span class="s2">&quot;benchmark_results.png&quot;</span>
<span class="linenos">328</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="kc">None</span><span class="p">:</span>
<span class="linenos">329</span><span class="w">    </span><span class="sd">&quot;&quot;&quot;Plot benchmark results and save to file.</span>
<span class="linenos">330</span>
<span class="linenos">331</span><span class="sd">    Args:</span>
<span class="linenos">332</span><span class="sd">        results: List of BenchmarkResult objects containing benchmark data</span>
<span class="linenos">333</span><span class="sd">        output_file: Output file path for the saved plot</span>
<span class="linenos">334</span><span class="sd">    &quot;&quot;&quot;</span>
<span class="linenos">335</span>    <span class="kn">import</span><span class="w"> </span><span class="nn">matplotlib</span>
<span class="linenos">336</span>    <span class="kn">import</span><span class="w"> </span><span class="nn">matplotlib.pyplot</span><span class="w"> </span><span class="k">as</span><span class="w"> </span><span class="nn">plt</span>
<span class="linenos">337</span>    <span class="kn">import</span><span class="w"> </span><span class="nn">pandas</span><span class="w"> </span><span class="k">as</span><span class="w"> </span><span class="nn">pd</span>
<span class="linenos">338</span>    <span class="kn">import</span><span class="w"> </span><span class="nn">seaborn</span><span class="w"> </span><span class="k">as</span><span class="w"> </span><span class="nn">sns</span>
<span class="linenos">339</span>
<span class="linenos">340</span>    <span class="n">matplotlib</span><span class="o">.</span><span class="n">use</span><span class="p">(</span><span class="s2">&quot;Agg&quot;</span><span class="p">)</span>  <span class="c1"># Use non-interactive backend</span>
<span class="linenos">341</span>
<span class="linenos">342</span>    <span class="n">data</span> <span class="o">=</span> <span class="p">[</span>
<span class="linenos">343</span>        <span class="p">{</span>
<span class="linenos">344</span>            <span class="s2">&quot;num_threads&quot;</span><span class="p">:</span> <span class="n">r</span><span class="o">.</span><span class="n">num_threads</span><span class="p">,</span>
<span class="linenos">345</span>            <span class="s2">&quot;qps&quot;</span><span class="p">:</span> <span class="n">r</span><span class="o">.</span><span class="n">qps</span><span class="p">,</span>
<span class="linenos">346</span>            <span class="s2">&quot;ci_lower&quot;</span><span class="p">:</span> <span class="n">r</span><span class="o">.</span><span class="n">ci_lower</span><span class="p">,</span>
<span class="linenos">347</span>            <span class="s2">&quot;ci_upper&quot;</span><span class="p">:</span> <span class="n">r</span><span class="o">.</span><span class="n">ci_upper</span><span class="p">,</span>
<span class="linenos">348</span>            <span class="s2">&quot;function&quot;</span><span class="p">:</span> <span class="n">r</span><span class="o">.</span><span class="n">function_name</span><span class="p">,</span>
<span class="linenos">349</span>            <span class="s2">&quot;duration&quot;</span><span class="p">:</span> <span class="sa">f</span><span class="s2">&quot;</span><span class="si">{</span><span class="n">r</span><span class="o">.</span><span class="n">duration_seconds</span><span class="si">}</span><span class="s2">s&quot;</span><span class="p">,</span>
<span class="linenos">350</span>        <span class="p">}</span>
<span class="linenos">351</span>        <span class="k">for</span> <span class="n">r</span> <span class="ow">in</span> <span class="n">results</span>
<span class="linenos">352</span>    <span class="p">]</span>
<span class="linenos">353</span>    <span class="n">df</span> <span class="o">=</span> <span class="n">pd</span><span class="o">.</span><span class="n">DataFrame</span><span class="p">(</span><span class="n">data</span><span class="p">)</span>
<span class="linenos">354</span>
<span class="linenos">355</span>    <span class="n">sns</span><span class="o">.</span><span class="n">set_theme</span><span class="p">(</span><span class="n">style</span><span class="o">=</span><span class="s2">&quot;whitegrid&quot;</span><span class="p">)</span>
<span class="linenos">356</span>    <span class="n">_</span><span class="p">,</span> <span class="n">ax</span> <span class="o">=</span> <span class="n">plt</span><span class="o">.</span><span class="n">subplots</span><span class="p">(</span><span class="n">figsize</span><span class="o">=</span><span class="p">(</span><span class="mi">12</span><span class="p">,</span> <span class="mi">6</span><span class="p">))</span>
<span class="linenos">357</span>    <span class="n">df</span><span class="p">[</span><span class="s2">&quot;label&quot;</span><span class="p">]</span> <span class="o">=</span> <span class="n">df</span><span class="p">[</span><span class="s2">&quot;function&quot;</span><span class="p">]</span> <span class="o">+</span> <span class="s2">&quot; (&quot;</span> <span class="o">+</span> <span class="n">df</span><span class="p">[</span><span class="s2">&quot;duration&quot;</span><span class="p">]</span> <span class="o">+</span> <span class="s2">&quot;)&quot;</span>
<span class="linenos">358</span>    <span class="k">for</span> <span class="n">label</span> <span class="ow">in</span> <span class="n">df</span><span class="p">[</span><span class="s2">&quot;label&quot;</span><span class="p">]</span><span class="o">.</span><span class="n">unique</span><span class="p">():</span>
<span class="linenos">359</span>        <span class="n">subset</span> <span class="o">=</span> <span class="n">df</span><span class="p">[</span><span class="n">df</span><span class="p">[</span><span class="s2">&quot;label&quot;</span><span class="p">]</span> <span class="o">==</span> <span class="n">label</span><span class="p">]</span><span class="o">.</span><span class="n">sort_values</span><span class="p">(</span><span class="s2">&quot;num_threads&quot;</span><span class="p">)</span>
<span class="linenos">360</span>        <span class="n">line</span> <span class="o">=</span> <span class="n">ax</span><span class="o">.</span><span class="n">plot</span><span class="p">(</span>
<span class="linenos">361</span>            <span class="n">subset</span><span class="p">[</span><span class="s2">&quot;num_threads&quot;</span><span class="p">],</span>
<span class="linenos">362</span>            <span class="n">subset</span><span class="p">[</span><span class="s2">&quot;qps&quot;</span><span class="p">],</span>
<span class="linenos">363</span>            <span class="n">marker</span><span class="o">=</span><span class="s2">&quot;o&quot;</span><span class="p">,</span>
<span class="linenos">364</span>            <span class="n">label</span><span class="o">=</span><span class="n">label</span><span class="p">,</span>
<span class="linenos">365</span>            <span class="n">linewidth</span><span class="o">=</span><span class="mi">2</span><span class="p">,</span>
<span class="linenos">366</span>        <span class="p">)</span>
<span class="linenos">367</span>
<span class="linenos">368</span>        <span class="c1"># Add confidence interval as shaded region</span>
<span class="linenos">369</span>        <span class="n">ax</span><span class="o">.</span><span class="n">fill_between</span><span class="p">(</span>
<span class="linenos">370</span>            <span class="n">subset</span><span class="p">[</span><span class="s2">&quot;num_threads&quot;</span><span class="p">],</span>
<span class="linenos">371</span>            <span class="n">subset</span><span class="p">[</span><span class="s2">&quot;ci_lower&quot;</span><span class="p">],</span>
<span class="linenos">372</span>            <span class="n">subset</span><span class="p">[</span><span class="s2">&quot;ci_upper&quot;</span><span class="p">],</span>
<span class="linenos">373</span>            <span class="n">alpha</span><span class="o">=</span><span class="mf">0.2</span><span class="p">,</span>
<span class="linenos">374</span>            <span class="n">color</span><span class="o">=</span><span class="n">line</span><span class="p">[</span><span class="mi">0</span><span class="p">]</span><span class="o">.</span><span class="n">get_color</span><span class="p">(),</span>
<span class="linenos">375</span>        <span class="p">)</span>
<span class="linenos">376</span>
<span class="linenos">377</span>    <span class="n">ax</span><span class="o">.</span><span class="n">set_xlabel</span><span class="p">(</span><span class="s2">&quot;Number of Threads&quot;</span><span class="p">,</span> <span class="n">fontsize</span><span class="o">=</span><span class="mi">12</span><span class="p">)</span>
<span class="linenos">378</span>    <span class="n">ax</span><span class="o">.</span><span class="n">set_ylabel</span><span class="p">(</span><span class="s2">&quot;QPS (Queries Per Second)&quot;</span><span class="p">,</span> <span class="n">fontsize</span><span class="o">=</span><span class="mi">12</span><span class="p">)</span>
<span class="linenos">379</span>    <span class="n">ax</span><span class="o">.</span><span class="n">set_title</span><span class="p">(</span><span class="s2">&quot;WAV Loading Performance Benchmark&quot;</span><span class="p">,</span> <span class="n">fontsize</span><span class="o">=</span><span class="mi">14</span><span class="p">,</span> <span class="n">fontweight</span><span class="o">=</span><span class="s2">&quot;bold&quot;</span><span class="p">)</span>
<span class="linenos">380</span>    <span class="n">ax</span><span class="o">.</span><span class="n">legend</span><span class="p">(</span><span class="n">title</span><span class="o">=</span><span class="s2">&quot;Function&quot;</span><span class="p">,</span> <span class="n">bbox_to_anchor</span><span class="o">=</span><span class="p">(</span><span class="mf">1.05</span><span class="p">,</span> <span class="mi">1</span><span class="p">),</span> <span class="n">loc</span><span class="o">=</span><span class="s2">&quot;upper left&quot;</span><span class="p">)</span>
<span class="linenos">381</span>    <span class="n">ax</span><span class="o">.</span><span class="n">grid</span><span class="p">(</span><span class="kc">True</span><span class="p">,</span> <span class="n">alpha</span><span class="o">=</span><span class="mf">0.3</span><span class="p">)</span>
<span class="linenos">382</span>
<span class="linenos">383</span>    <span class="n">plt</span><span class="o">.</span><span class="n">tight_layout</span><span class="p">()</span>
<span class="linenos">384</span>    <span class="n">plt</span><span class="o">.</span><span class="n">savefig</span><span class="p">(</span><span class="n">output_file</span><span class="p">,</span> <span class="n">dpi</span><span class="o">=</span><span class="mi">300</span><span class="p">,</span> <span class="n">bbox_inches</span><span class="o">=</span><span class="s2">&quot;tight&quot;</span><span class="p">)</span>
<span class="linenos">385</span>    <span class="nb">print</span><span class="p">(</span><span class="sa">f</span><span class="s2">&quot;Plot saved to </span><span class="si">{</span><span class="n">output_file</span><span class="si">}</span><span class="s2">&quot;</span><span class="p">)</span>
<span class="linenos">386</span>
<span class="linenos">387</span>
<span class="linenos">388</span><span class="k">def</span><span class="w"> </span><span class="nf">_parse_args</span><span class="p">()</span> <span class="o">-&gt;</span> <span class="n">argparse</span><span class="o">.</span><span class="n">Namespace</span><span class="p">:</span>
<span class="linenos">389</span><span class="w">    </span><span class="sd">&quot;&quot;&quot;Parse command line arguments for the benchmark script.</span>
<span class="linenos">390</span>
<span class="linenos">391</span><span class="sd">    Returns:</span>
<span class="linenos">392</span><span class="sd">        Parsed command line arguments</span>
<span class="linenos">393</span><span class="sd">    &quot;&quot;&quot;</span>
<span class="linenos">394</span>    <span class="n">parser</span> <span class="o">=</span> <span class="n">argparse</span><span class="o">.</span><span class="n">ArgumentParser</span><span class="p">(</span><span class="n">description</span><span class="o">=</span><span class="s2">&quot;Benchmark WAV loading performance&quot;</span><span class="p">)</span>
<span class="linenos">395</span>    <span class="n">parser</span><span class="o">.</span><span class="n">add_argument</span><span class="p">(</span>
<span class="linenos">396</span>        <span class="s2">&quot;--plot&quot;</span><span class="p">,</span>
<span class="linenos">397</span>        <span class="n">action</span><span class="o">=</span><span class="s2">&quot;store_true&quot;</span><span class="p">,</span>
<span class="linenos">398</span>        <span class="n">help</span><span class="o">=</span><span class="s2">&quot;Generate and save a plot of the benchmark results&quot;</span><span class="p">,</span>
<span class="linenos">399</span>    <span class="p">)</span>
<span class="linenos">400</span>    <span class="n">parser</span><span class="o">.</span><span class="n">add_argument</span><span class="p">(</span>
<span class="linenos">401</span>        <span class="s2">&quot;--output&quot;</span><span class="p">,</span>
<span class="linenos">402</span>        <span class="nb">type</span><span class="o">=</span><span class="nb">str</span><span class="p">,</span>
<span class="linenos">403</span>        <span class="n">default</span><span class="o">=</span><span class="s2">&quot;benchmark_results.png&quot;</span><span class="p">,</span>
<span class="linenos">404</span>        <span class="n">help</span><span class="o">=</span><span class="s2">&quot;Output file path for the plot (default: benchmark_results.png)&quot;</span><span class="p">,</span>
<span class="linenos">405</span>    <span class="p">)</span>
<span class="linenos">406</span>    <span class="k">return</span> <span class="n">parser</span><span class="o">.</span><span class="n">parse_args</span><span class="p">()</span>
<span class="linenos">407</span>
<span class="linenos">408</span>
<span class="linenos">409</span><span class="k">def</span><span class="w"> </span><span class="nf">_suffix</span><span class="p">(</span><span class="n">path</span><span class="p">:</span> <span class="nb">str</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="nb">str</span><span class="p">:</span>
<span class="linenos">410</span>    <span class="n">p1</span><span class="p">,</span> <span class="n">p2</span> <span class="o">=</span> <span class="n">os</span><span class="o">.</span><span class="n">path</span><span class="o">.</span><span class="n">splitext</span><span class="p">(</span><span class="n">path</span><span class="p">)</span>
<span class="linenos">411</span>    <span class="k">return</span> <span class="sa">f</span><span class="s2">&quot;</span><span class="si">{</span><span class="n">p1</span><span class="si">}</span><span class="s2">_2</span><span class="si">{</span><span class="n">p2</span><span class="si">}</span><span class="s2">&quot;</span>
<span class="linenos">412</span>
<span class="linenos">413</span>
<span class="linenos">414</span><span class="k">def</span><span class="w"> </span><span class="nf">main</span><span class="p">()</span> <span class="o">-&gt;</span> <span class="kc">None</span><span class="p">:</span>
<span class="linenos">415</span><span class="w">    </span><span class="sd">&quot;&quot;&quot;Run comprehensive benchmark suite for WAV loading performance.</span>
<span class="linenos">416</span>
<span class="linenos">417</span><span class="sd">    Benchmarks multiple configurations of audio files with different durations,</span>
<span class="linenos">418</span><span class="sd">    comparing spdl.io.load_wav, spdl.io.load_audio, and soundfile libraries</span>
<span class="linenos">419</span><span class="sd">    across various thread counts (1, 2, 4, 8, 16).</span>
<span class="linenos">420</span><span class="sd">    &quot;&quot;&quot;</span>
<span class="linenos">421</span>    <span class="n">args</span> <span class="o">=</span> <span class="n">_parse_args</span><span class="p">()</span>
<span class="linenos">422</span>
<span class="linenos">423</span>    <span class="n">benchmark_configs</span> <span class="o">=</span> <span class="p">[</span>
<span class="linenos">424</span>        <span class="c1"># (sample_rate, num_channels, bits_per_sample, duration_seconds, iterations)</span>
<span class="linenos">425</span>        <span class="c1"># BenchmarkConfig(8000, 1, 16, 1.0),  # Low quality mono</span>
<span class="linenos">426</span>        <span class="c1"># BenchmarkConfig(16000, 1, 16, 1.0),  # Speech quality mono</span>
<span class="linenos">427</span>        <span class="c1"># BenchmarkConfig(48000, 2, 16, 1.0),  # High quality stereo</span>
<span class="linenos">428</span>        <span class="c1"># BenchmarkConfig(48000, 8, 16, 1.0),  # Multi-channel audio</span>
<span class="linenos">429</span>        <span class="n">BenchmarkConfig</span><span class="p">(</span><span class="mi">44100</span><span class="p">,</span> <span class="mi">2</span><span class="p">,</span> <span class="mi">16</span><span class="p">,</span> <span class="mf">1.0</span><span class="p">),</span>  <span class="c1"># CD quality stereo</span>
<span class="linenos">430</span>        <span class="n">BenchmarkConfig</span><span class="p">(</span><span class="mi">44100</span><span class="p">,</span> <span class="mi">2</span><span class="p">,</span> <span class="mi">16</span><span class="p">,</span> <span class="mf">10.0</span><span class="p">),</span>  <span class="c1">#</span>
<span class="linenos">431</span>        <span class="n">BenchmarkConfig</span><span class="p">(</span><span class="mi">44100</span><span class="p">,</span> <span class="mi">2</span><span class="p">,</span> <span class="mi">16</span><span class="p">,</span> <span class="mf">60.0</span><span class="p">),</span>  <span class="c1">#</span>
<span class="linenos">432</span>        <span class="c1"># (44100, 2, 24, 1.0, 100),  # 24-bit audio</span>
<span class="linenos">433</span>    <span class="p">]</span>
<span class="linenos">434</span>
<span class="linenos">435</span>    <span class="n">results</span><span class="p">:</span> <span class="nb">list</span><span class="p">[</span><span class="n">BenchmarkResult</span><span class="p">]</span> <span class="o">=</span> <span class="p">[]</span>
<span class="linenos">436</span>
<span class="linenos">437</span>    <span class="k">for</span> <span class="n">cfg</span> <span class="ow">in</span> <span class="n">benchmark_configs</span><span class="p">:</span>
<span class="linenos">438</span>        <span class="nb">print</span><span class="p">(</span><span class="n">cfg</span><span class="p">)</span>
<span class="linenos">439</span>        <span class="n">wav_data</span><span class="p">,</span> <span class="n">ref</span> <span class="o">=</span> <span class="n">create_wav_data</span><span class="p">(</span>
<span class="linenos">440</span>            <span class="n">sample_rate</span><span class="o">=</span><span class="n">cfg</span><span class="o">.</span><span class="n">sample_rate</span><span class="p">,</span>
<span class="linenos">441</span>            <span class="n">num_channels</span><span class="o">=</span><span class="n">cfg</span><span class="o">.</span><span class="n">num_channels</span><span class="p">,</span>
<span class="linenos">442</span>            <span class="n">bits_per_sample</span><span class="o">=</span><span class="n">cfg</span><span class="o">.</span><span class="n">bits_per_sample</span><span class="p">,</span>
<span class="linenos">443</span>            <span class="n">duration_seconds</span><span class="o">=</span><span class="n">cfg</span><span class="o">.</span><span class="n">duration_seconds</span><span class="p">,</span>
<span class="linenos">444</span>        <span class="p">)</span>
<span class="linenos">445</span>        <span class="nb">print</span><span class="p">(</span>
<span class="linenos">446</span>            <span class="sa">f</span><span class="s2">&quot;Threads,&quot;</span>
<span class="linenos">447</span>            <span class="sa">f</span><span class="s2">&quot;SPDL WAV QPS (</span><span class="si">{</span><span class="n">cfg</span><span class="o">.</span><span class="n">duration_seconds</span><span class="si">}</span><span class="s2"> sec),CI Lower, CI Upper,&quot;</span>
<span class="linenos">448</span>            <span class="sa">f</span><span class="s2">&quot;SPDL Audio QPS (</span><span class="si">{</span><span class="n">cfg</span><span class="o">.</span><span class="n">duration_seconds</span><span class="si">}</span><span class="s2"> sec),CI Lower, CI Upper,&quot;</span>
<span class="linenos">449</span>            <span class="sa">f</span><span class="s2">&quot;soundfile QPS (</span><span class="si">{</span><span class="n">cfg</span><span class="o">.</span><span class="n">duration_seconds</span><span class="si">}</span><span class="s2"> sec),CI Lower, CI Upper&quot;</span>
<span class="linenos">450</span>        <span class="p">)</span>
<span class="linenos">451</span>        <span class="k">for</span> <span class="n">num_threads</span> <span class="ow">in</span> <span class="p">[</span><span class="mi">1</span><span class="p">,</span> <span class="mi">2</span><span class="p">,</span> <span class="mi">4</span><span class="p">,</span> <span class="mi">8</span><span class="p">,</span> <span class="mi">16</span><span class="p">]:</span>
<span class="linenos">452</span>            <span class="n">spdl_wav_result</span><span class="p">,</span> <span class="n">spdl_audio_result</span><span class="p">,</span> <span class="n">soundfile_result</span> <span class="o">=</span> <span class="n">run_benchmark_suite</span><span class="p">(</span>
<span class="linenos">453</span>                <span class="n">wav_data</span><span class="p">,</span>
<span class="linenos">454</span>                <span class="n">ref</span><span class="p">,</span>
<span class="linenos">455</span>                <span class="n">num_threads</span><span class="o">=</span><span class="n">num_threads</span><span class="p">,</span>
<span class="linenos">456</span>                <span class="n">duration_seconds</span><span class="o">=</span><span class="n">cfg</span><span class="o">.</span><span class="n">duration_seconds</span><span class="p">,</span>
<span class="linenos">457</span>            <span class="p">)</span>
<span class="linenos">458</span>            <span class="n">results</span><span class="o">.</span><span class="n">extend</span><span class="p">([</span><span class="n">spdl_wav_result</span><span class="p">,</span> <span class="n">spdl_audio_result</span><span class="p">,</span> <span class="n">soundfile_result</span><span class="p">])</span>
<span class="linenos">459</span>            <span class="nb">print</span><span class="p">(</span>
<span class="linenos">460</span>                <span class="sa">f</span><span class="s2">&quot;</span><span class="si">{</span><span class="n">num_threads</span><span class="si">}</span><span class="s2">,&quot;</span>
<span class="linenos">461</span>                <span class="sa">f</span><span class="s2">&quot;</span><span class="si">{</span><span class="n">spdl_wav_result</span><span class="o">.</span><span class="n">qps</span><span class="si">:</span><span class="s2">.2f</span><span class="si">}</span><span class="s2">,</span><span class="si">{</span><span class="n">spdl_wav_result</span><span class="o">.</span><span class="n">ci_lower</span><span class="si">:</span><span class="s2">.2f</span><span class="si">}</span><span class="s2">,</span><span class="si">{</span><span class="n">spdl_wav_result</span><span class="o">.</span><span class="n">ci_upper</span><span class="si">:</span><span class="s2">.2f</span><span class="si">}</span><span class="s2">,&quot;</span>
<span class="linenos">462</span>                <span class="sa">f</span><span class="s2">&quot;</span><span class="si">{</span><span class="n">spdl_audio_result</span><span class="o">.</span><span class="n">qps</span><span class="si">:</span><span class="s2">.2f</span><span class="si">}</span><span class="s2">,</span><span class="si">{</span><span class="n">spdl_audio_result</span><span class="o">.</span><span class="n">ci_lower</span><span class="si">:</span><span class="s2">.2f</span><span class="si">}</span><span class="s2">,</span><span class="si">{</span><span class="n">spdl_audio_result</span><span class="o">.</span><span class="n">ci_upper</span><span class="si">:</span><span class="s2">.2f</span><span class="si">}</span><span class="s2">,&quot;</span>
<span class="linenos">463</span>                <span class="sa">f</span><span class="s2">&quot;</span><span class="si">{</span><span class="n">soundfile_result</span><span class="o">.</span><span class="n">qps</span><span class="si">:</span><span class="s2">.2f</span><span class="si">}</span><span class="s2">,</span><span class="si">{</span><span class="n">soundfile_result</span><span class="o">.</span><span class="n">ci_lower</span><span class="si">:</span><span class="s2">.2f</span><span class="si">}</span><span class="s2">,</span><span class="si">{</span><span class="n">soundfile_result</span><span class="o">.</span><span class="n">ci_upper</span><span class="si">:</span><span class="s2">.2f</span><span class="si">}</span><span class="s2">&quot;</span>
<span class="linenos">464</span>            <span class="p">)</span>
<span class="linenos">465</span>
<span class="linenos">466</span>    <span class="k">if</span> <span class="n">args</span><span class="o">.</span><span class="n">plot</span><span class="p">:</span>
<span class="linenos">467</span>        <span class="n">plot_benchmark_results</span><span class="p">(</span><span class="n">results</span><span class="p">,</span> <span class="n">args</span><span class="o">.</span><span class="n">output</span><span class="p">)</span>
<span class="linenos">468</span>        <span class="n">k</span> <span class="o">=</span> <span class="s2">&quot;spdl.io.load_wav&quot;</span>
<span class="linenos">469</span>        <span class="n">plot_benchmark_results</span><span class="p">(</span>
<span class="linenos">470</span>            <span class="p">[</span><span class="n">r</span> <span class="k">for</span> <span class="n">r</span> <span class="ow">in</span> <span class="n">results</span> <span class="k">if</span> <span class="n">r</span><span class="o">.</span><span class="n">function_name</span> <span class="o">!=</span> <span class="n">k</span><span class="p">],</span>
<span class="linenos">471</span>            <span class="n">_suffix</span><span class="p">(</span><span class="n">args</span><span class="o">.</span><span class="n">output</span><span class="p">),</span>
<span class="linenos">472</span>        <span class="p">)</span>
<span class="linenos">473</span>
<span class="linenos">474</span>
<span class="linenos">475</span><span class="k">if</span> <span class="vm">__name__</span> <span class="o">==</span> <span class="s2">&quot;__main__&quot;</span><span class="p">:</span>
<span class="linenos">476</span>    <span class="n">main</span><span class="p">()</span>
</pre></div>
</div>
</details></section>
<section id="functions">
<h2>Functions<a class="headerlink" href="#functions" title="Link to this heading">¶</a></h2>
<p class="rubric">Functions</p>
<dl class="py function">
<dt class="sig sig-object py" id="benchmark_wav.create_wav_data">
<span class="sig-name descname"><span class="pre">create_wav_data</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">sample_rate</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><a class="reference external" href="https://docs.python.org/3/library/functions.html#int" title="(in Python v3.14)"><span class="pre">int</span></a></span><span class="w"> </span><span class="o"><span class="pre">=</span></span><span class="w"> </span><span class="default_value"><span class="pre">44100</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">num_channels</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><a class="reference external" href="https://docs.python.org/3/library/functions.html#int" title="(in Python v3.14)"><span class="pre">int</span></a></span><span class="w"> </span><span class="o"><span class="pre">=</span></span><span class="w"> </span><span class="default_value"><span class="pre">2</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">bits_per_sample</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><a class="reference external" href="https://docs.python.org/3/library/functions.html#int" title="(in Python v3.14)"><span class="pre">int</span></a></span><span class="w"> </span><span class="o"><span class="pre">=</span></span><span class="w"> </span><span class="default_value"><span class="pre">16</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">duration_seconds</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><a class="reference external" href="https://docs.python.org/3/library/functions.html#float" title="(in Python v3.14)"><span class="pre">float</span></a></span><span class="w"> </span><span class="o"><span class="pre">=</span></span><span class="w"> </span><span class="default_value"><span class="pre">1.0</span></span></em><span class="sig-paren">)</span> <span class="sig-return"><span class="sig-return-icon">&#x2192;</span> <span class="sig-return-typehint"><a class="reference external" href="https://docs.python.org/3/library/stdtypes.html#tuple" title="(in Python v3.14)"><span class="pre">tuple</span></a><span class="p"><span class="pre">[</span></span><a class="reference external" href="https://docs.python.org/3/library/stdtypes.html#bytes" title="(in Python v3.14)"><span class="pre">bytes</span></a><span class="p"><span class="pre">,</span></span><span class="w"> </span><a class="reference external" href="https://numpy.org/doc/stable/reference/generated/numpy.ndarray.html#numpy.ndarray" title="(in NumPy v2.3)"><span class="pre">ndarray</span></a><span class="p"><span class="pre">[</span></span><a class="reference external" href="https://docs.python.org/3/library/stdtypes.html#tuple" title="(in Python v3.14)"><span class="pre">tuple</span></a><span class="p"><span class="pre">[</span></span><a class="reference external" href="https://docs.python.org/3/library/typing.html#typing.Any" title="(in Python v3.14)"><span class="pre">Any</span></a><span class="p"><span class="pre">,</span></span><span class="w"> </span><span class="p"><span class="pre">...</span></span><span class="p"><span class="pre">]</span></span><span class="p"><span class="pre">,</span></span><span class="w"> </span><a class="reference external" href="https://numpy.org/doc/stable/reference/generated/numpy.dtype.html#numpy.dtype" title="(in NumPy v2.3)"><span class="pre">dtype</span></a><span class="p"><span class="pre">[</span></span><span class="pre">_ScalarT</span><span class="p"><span class="pre">]</span></span><span class="p"><span class="pre">]</span></span><span class="p"><span class="pre">]</span></span></span></span><a class="reference external" href="https://github.com/facebookresearch/spdl/tree/main//examples/benchmark_wav.py?#L92-L127"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#benchmark_wav.create_wav_data" title="Link to this definition">¶</a></dt>
<dd><p>Create a WAV file in memory for benchmarking.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters<span class="colon">:</span></dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>sample_rate</strong> – Sample rate in Hz</p></li>
<li><p><strong>num_channels</strong> – Number of audio channels</p></li>
<li><p><strong>bits_per_sample</strong> – Bits per sample (16 or 32)</p></li>
<li><p><strong>duration_seconds</strong> – Duration of audio in seconds</p></li>
</ul>
</dd>
<dt class="field-even">Returns<span class="colon">:</span></dt>
<dd class="field-even"><p>Tuple of (WAV file as bytes, audio samples array)</p>
</dd>
</dl>
</dd></dl>

<dl class="py function">
<dt class="sig sig-object py" id="benchmark_wav.load_sf">
<span class="sig-name descname"><span class="pre">load_sf</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">wav_data</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><a class="reference external" href="https://docs.python.org/3/library/stdtypes.html#bytes" title="(in Python v3.14)"><span class="pre">bytes</span></a></span></em><span class="sig-paren">)</span> <span class="sig-return"><span class="sig-return-icon">&#x2192;</span> <span class="sig-return-typehint"><a class="reference external" href="https://numpy.org/doc/stable/reference/generated/numpy.ndarray.html#numpy.ndarray" title="(in NumPy v2.3)"><span class="pre">ndarray</span></a><span class="p"><span class="pre">[</span></span><a class="reference external" href="https://docs.python.org/3/library/stdtypes.html#tuple" title="(in Python v3.14)"><span class="pre">tuple</span></a><span class="p"><span class="pre">[</span></span><a class="reference external" href="https://docs.python.org/3/library/typing.html#typing.Any" title="(in Python v3.14)"><span class="pre">Any</span></a><span class="p"><span class="pre">,</span></span><span class="w"> </span><span class="p"><span class="pre">...</span></span><span class="p"><span class="pre">]</span></span><span class="p"><span class="pre">,</span></span><span class="w"> </span><a class="reference external" href="https://numpy.org/doc/stable/reference/generated/numpy.dtype.html#numpy.dtype" title="(in NumPy v2.3)"><span class="pre">dtype</span></a><span class="p"><span class="pre">[</span></span><span class="pre">_ScalarT</span><span class="p"><span class="pre">]</span></span><span class="p"><span class="pre">]</span></span></span></span><a class="reference external" href="https://github.com/facebookresearch/spdl/tree/main//examples/benchmark_wav.py?#L130-L141"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#benchmark_wav.load_sf" title="Link to this definition">¶</a></dt>
<dd><p>Load WAV data using soundfile library.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters<span class="colon">:</span></dt>
<dd class="field-odd"><p><strong>wav_data</strong> – WAV file data as bytes</p>
</dd>
<dt class="field-even">Returns<span class="colon">:</span></dt>
<dd class="field-even"><p>Audio samples array as int16 numpy array</p>
</dd>
</dl>
</dd></dl>

<dl class="py function">
<dt class="sig sig-object py" id="benchmark_wav.load_spdl_audio">
<span class="sig-name descname"><span class="pre">load_spdl_audio</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">wav_data</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><a class="reference external" href="https://docs.python.org/3/library/stdtypes.html#bytes" title="(in Python v3.14)"><span class="pre">bytes</span></a></span></em><span class="sig-paren">)</span> <span class="sig-return"><span class="sig-return-icon">&#x2192;</span> <span class="sig-return-typehint"><a class="reference external" href="https://numpy.org/doc/stable/reference/generated/numpy.ndarray.html#numpy.ndarray" title="(in NumPy v2.3)"><span class="pre">ndarray</span></a><span class="p"><span class="pre">[</span></span><a class="reference external" href="https://docs.python.org/3/library/stdtypes.html#tuple" title="(in Python v3.14)"><span class="pre">tuple</span></a><span class="p"><span class="pre">[</span></span><a class="reference external" href="https://docs.python.org/3/library/typing.html#typing.Any" title="(in Python v3.14)"><span class="pre">Any</span></a><span class="p"><span class="pre">,</span></span><span class="w"> </span><span class="p"><span class="pre">...</span></span><span class="p"><span class="pre">]</span></span><span class="p"><span class="pre">,</span></span><span class="w"> </span><a class="reference external" href="https://numpy.org/doc/stable/reference/generated/numpy.dtype.html#numpy.dtype" title="(in NumPy v2.3)"><span class="pre">dtype</span></a><span class="p"><span class="pre">[</span></span><span class="pre">_ScalarT</span><span class="p"><span class="pre">]</span></span><span class="p"><span class="pre">]</span></span></span></span><a class="reference external" href="https://github.com/facebookresearch/spdl/tree/main//examples/benchmark_wav.py?#L144-L153"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#benchmark_wav.load_spdl_audio" title="Link to this definition">¶</a></dt>
<dd><p>Load WAV data using <a class="reference internal" href="spdl.io.load_audio.html#spdl.io.load_audio" title="spdl.io.load_audio"><code class="xref py py-func docutils literal notranslate"><span class="pre">spdl.io.load_audio()</span></code></a> function.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters<span class="colon">:</span></dt>
<dd class="field-odd"><p><strong>wav_data</strong> – WAV file data as bytes</p>
</dd>
<dt class="field-even">Returns<span class="colon">:</span></dt>
<dd class="field-even"><p>Audio samples array as numpy array</p>
</dd>
</dl>
</dd></dl>

<dl class="py function">
<dt class="sig sig-object py" id="benchmark_wav.load_spdl_wav">
<span class="sig-name descname"><span class="pre">load_spdl_wav</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">wav_data</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><a class="reference external" href="https://docs.python.org/3/library/stdtypes.html#bytes" title="(in Python v3.14)"><span class="pre">bytes</span></a></span></em><span class="sig-paren">)</span> <span class="sig-return"><span class="sig-return-icon">&#x2192;</span> <span class="sig-return-typehint"><a class="reference external" href="https://numpy.org/doc/stable/reference/generated/numpy.ndarray.html#numpy.ndarray" title="(in NumPy v2.3)"><span class="pre">ndarray</span></a><span class="p"><span class="pre">[</span></span><a class="reference external" href="https://docs.python.org/3/library/stdtypes.html#tuple" title="(in Python v3.14)"><span class="pre">tuple</span></a><span class="p"><span class="pre">[</span></span><a class="reference external" href="https://docs.python.org/3/library/typing.html#typing.Any" title="(in Python v3.14)"><span class="pre">Any</span></a><span class="p"><span class="pre">,</span></span><span class="w"> </span><span class="p"><span class="pre">...</span></span><span class="p"><span class="pre">]</span></span><span class="p"><span class="pre">,</span></span><span class="w"> </span><a class="reference external" href="https://numpy.org/doc/stable/reference/generated/numpy.dtype.html#numpy.dtype" title="(in NumPy v2.3)"><span class="pre">dtype</span></a><span class="p"><span class="pre">[</span></span><span class="pre">_ScalarT</span><span class="p"><span class="pre">]</span></span><span class="p"><span class="pre">]</span></span></span></span><a class="reference external" href="https://github.com/facebookresearch/spdl/tree/main//examples/benchmark_wav.py?#L156-L165"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#benchmark_wav.load_spdl_wav" title="Link to this definition">¶</a></dt>
<dd><p>Load WAV data using <a class="reference internal" href="spdl.io.load_wav.html#spdl.io.load_wav" title="spdl.io.load_wav"><code class="xref py py-func docutils literal notranslate"><span class="pre">spdl.io.load_wav()</span></code></a> function.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters<span class="colon">:</span></dt>
<dd class="field-odd"><p><strong>wav_data</strong> – WAV file data as bytes</p>
</dd>
<dt class="field-even">Returns<span class="colon">:</span></dt>
<dd class="field-even"><p>Audio samples array as numpy array</p>
</dd>
</dl>
</dd></dl>

<dl class="py function">
<dt class="sig sig-object py" id="benchmark_wav.benchmark">
<span class="sig-name descname"><span class="pre">benchmark</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">name</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><a class="reference external" href="https://docs.python.org/3/library/stdtypes.html#str" title="(in Python v3.14)"><span class="pre">str</span></a></span></em>, <em class="sig-param"><span class="n"><span class="pre">func</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><a class="reference external" href="https://docs.python.org/3/library/collections.abc.html#collections.abc.Callable" title="(in Python v3.14)"><span class="pre">Callable</span></a><span class="p"><span class="pre">[</span></span><span class="p"><span class="pre">[</span></span><span class="p"><span class="pre">]</span></span><span class="p"><span class="pre">,</span></span><span class="w"> </span><a class="reference external" href="https://numpy.org/doc/stable/reference/generated/numpy.ndarray.html#numpy.ndarray" title="(in NumPy v2.3)"><span class="pre">ndarray</span></a><span class="p"><span class="pre">[</span></span><a class="reference external" href="https://docs.python.org/3/library/stdtypes.html#tuple" title="(in Python v3.14)"><span class="pre">tuple</span></a><span class="p"><span class="pre">[</span></span><a class="reference external" href="https://docs.python.org/3/library/typing.html#typing.Any" title="(in Python v3.14)"><span class="pre">Any</span></a><span class="p"><span class="pre">,</span></span><span class="w"> </span><span class="p"><span class="pre">...</span></span><span class="p"><span class="pre">]</span></span><span class="p"><span class="pre">,</span></span><span class="w"> </span><a class="reference external" href="https://numpy.org/doc/stable/reference/generated/numpy.dtype.html#numpy.dtype" title="(in NumPy v2.3)"><span class="pre">dtype</span></a><span class="p"><span class="pre">[</span></span><span class="pre">_ScalarT</span><span class="p"><span class="pre">]</span></span><span class="p"><span class="pre">]</span></span><span class="p"><span class="pre">]</span></span></span></em>, <em class="sig-param"><span class="n"><span class="pre">iterations</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><a class="reference external" href="https://docs.python.org/3/library/functions.html#int" title="(in Python v3.14)"><span class="pre">int</span></a></span></em>, <em class="sig-param"><span class="n"><span class="pre">num_threads</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><a class="reference external" href="https://docs.python.org/3/library/functions.html#int" title="(in Python v3.14)"><span class="pre">int</span></a></span></em>, <em class="sig-param"><span class="n"><span class="pre">num_sets</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><a class="reference external" href="https://docs.python.org/3/library/functions.html#int" title="(in Python v3.14)"><span class="pre">int</span></a></span></em>, <em class="sig-param"><span class="n"><span class="pre">duration_seconds</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><a class="reference external" href="https://docs.python.org/3/library/functions.html#float" title="(in Python v3.14)"><span class="pre">float</span></a></span></em><span class="sig-paren">)</span> <span class="sig-return"><span class="sig-return-icon">&#x2192;</span> <span class="sig-return-typehint"><a class="reference external" href="https://docs.python.org/3/library/stdtypes.html#tuple" title="(in Python v3.14)"><span class="pre">tuple</span></a><span class="p"><span class="pre">[</span></span><a class="reference internal" href="#benchmark_wav.BenchmarkResult" title="benchmark_wav.BenchmarkResult"><span class="pre">BenchmarkResult</span></a><span class="p"><span class="pre">,</span></span><span class="w"> </span><a class="reference external" href="https://numpy.org/doc/stable/reference/generated/numpy.ndarray.html#numpy.ndarray" title="(in NumPy v2.3)"><span class="pre">ndarray</span></a><span class="p"><span class="pre">[</span></span><a class="reference external" href="https://docs.python.org/3/library/stdtypes.html#tuple" title="(in Python v3.14)"><span class="pre">tuple</span></a><span class="p"><span class="pre">[</span></span><a class="reference external" href="https://docs.python.org/3/library/typing.html#typing.Any" title="(in Python v3.14)"><span class="pre">Any</span></a><span class="p"><span class="pre">,</span></span><span class="w"> </span><span class="p"><span class="pre">...</span></span><span class="p"><span class="pre">]</span></span><span class="p"><span class="pre">,</span></span><span class="w"> </span><a class="reference external" href="https://numpy.org/doc/stable/reference/generated/numpy.dtype.html#numpy.dtype" title="(in NumPy v2.3)"><span class="pre">dtype</span></a><span class="p"><span class="pre">[</span></span><span class="pre">_ScalarT</span><span class="p"><span class="pre">]</span></span><span class="p"><span class="pre">]</span></span><span class="p"><span class="pre">]</span></span></span></span><a class="reference external" href="https://github.com/facebookresearch/spdl/tree/main//examples/benchmark_wav.py?#L181-L247"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#benchmark_wav.benchmark" title="Link to this definition">¶</a></dt>
<dd><p>Benchmark a function using multiple threads and calculate statistics.</p>
<p>Executes a warmup phase followed by multiple benchmark sets to compute
performance metrics including mean queries per second (QPS) and 95%
confidence intervals using Student’s t-distribution.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters<span class="colon">:</span></dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>name</strong> – Descriptive name for the benchmark (used in results)</p></li>
<li><p><strong>func</strong> – Callable function to benchmark (takes no args, returns NDArray)</p></li>
<li><p><strong>iterations</strong> – Total number of function calls per benchmark set</p></li>
<li><p><strong>num_threads</strong> – Number of concurrent threads for parallel execution</p></li>
<li><p><strong>num_sets</strong> – Number of independent benchmark sets for confidence interval</p></li>
<li><p><strong>duration_seconds</strong> – Duration of audio file being processed (for metadata)</p></li>
</ul>
</dd>
<dt class="field-even">Returns<span class="colon">:</span></dt>
<dd class="field-even"><p><ul class="simple">
<li><p>BenchmarkResult with timing statistics, QPS, confidence intervals</p></li>
<li><p>Output NDArray from the last function execution</p></li>
</ul>
</p>
</dd>
<dt class="field-odd">Return type<span class="colon">:</span></dt>
<dd class="field-odd"><p>Tuple containing</p>
</dd>
</dl>
</dd></dl>

<dl class="py function">
<dt class="sig sig-object py" id="benchmark_wav.run_benchmark_suite">
<span class="sig-name descname"><span class="pre">run_benchmark_suite</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">wav_data</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><a class="reference external" href="https://docs.python.org/3/library/stdtypes.html#bytes" title="(in Python v3.14)"><span class="pre">bytes</span></a></span></em>, <em class="sig-param"><span class="n"><span class="pre">ref</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><a class="reference external" href="https://numpy.org/doc/stable/reference/generated/numpy.ndarray.html#numpy.ndarray" title="(in NumPy v2.3)"><span class="pre">ndarray</span></a><span class="p"><span class="pre">[</span></span><a class="reference external" href="https://docs.python.org/3/library/stdtypes.html#tuple" title="(in Python v3.14)"><span class="pre">tuple</span></a><span class="p"><span class="pre">[</span></span><a class="reference external" href="https://docs.python.org/3/library/typing.html#typing.Any" title="(in Python v3.14)"><span class="pre">Any</span></a><span class="p"><span class="pre">,</span></span><span class="w"> </span><span class="p"><span class="pre">...</span></span><span class="p"><span class="pre">]</span></span><span class="p"><span class="pre">,</span></span><span class="w"> </span><a class="reference external" href="https://numpy.org/doc/stable/reference/generated/numpy.dtype.html#numpy.dtype" title="(in NumPy v2.3)"><span class="pre">dtype</span></a><span class="p"><span class="pre">[</span></span><span class="pre">_ScalarT</span><span class="p"><span class="pre">]</span></span><span class="p"><span class="pre">]</span></span></span></em>, <em class="sig-param"><span class="n"><span class="pre">num_threads</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><a class="reference external" href="https://docs.python.org/3/library/functions.html#int" title="(in Python v3.14)"><span class="pre">int</span></a></span></em>, <em class="sig-param"><span class="n"><span class="pre">duration_seconds</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><a class="reference external" href="https://docs.python.org/3/library/functions.html#float" title="(in Python v3.14)"><span class="pre">float</span></a></span></em><span class="sig-paren">)</span> <span class="sig-return"><span class="sig-return-icon">&#x2192;</span> <span class="sig-return-typehint"><a class="reference external" href="https://docs.python.org/3/library/stdtypes.html#tuple" title="(in Python v3.14)"><span class="pre">tuple</span></a><span class="p"><span class="pre">[</span></span><a class="reference internal" href="#benchmark_wav.BenchmarkResult" title="benchmark_wav.BenchmarkResult"><span class="pre">BenchmarkResult</span></a><span class="p"><span class="pre">,</span></span><span class="w"> </span><a class="reference internal" href="#benchmark_wav.BenchmarkResult" title="benchmark_wav.BenchmarkResult"><span class="pre">BenchmarkResult</span></a><span class="p"><span class="pre">,</span></span><span class="w"> </span><a class="reference internal" href="#benchmark_wav.BenchmarkResult" title="benchmark_wav.BenchmarkResult"><span class="pre">BenchmarkResult</span></a><span class="p"><span class="pre">]</span></span></span></span><a class="reference external" href="https://github.com/facebookresearch/spdl/tree/main//examples/benchmark_wav.py?#L250-L306"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#benchmark_wav.run_benchmark_suite" title="Link to this definition">¶</a></dt>
<dd><p>Run benchmarks for both libraries with given parameters.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters<span class="colon">:</span></dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>wav_data</strong> – WAV file data as bytes</p></li>
<li><p><strong>ref</strong> – Reference audio array for validation</p></li>
<li><p><strong>num_threads</strong> – Number of threads (use 1 for single-threaded)</p></li>
<li><p><strong>duration_seconds</strong> – Duration of audio in seconds</p></li>
</ul>
</dd>
<dt class="field-even">Returns<span class="colon">:</span></dt>
<dd class="field-even"><p>Tuple of (spdl_wav_result, spdl_audio_result, soundfile_result)</p>
</dd>
</dl>
</dd></dl>

<dl class="py function">
<dt class="sig sig-object py" id="benchmark_wav.plot_benchmark_results">
<span class="sig-name descname"><span class="pre">plot_benchmark_results</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">results</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><a class="reference external" href="https://docs.python.org/3/library/stdtypes.html#list" title="(in Python v3.14)"><span class="pre">list</span></a><span class="p"><span class="pre">[</span></span><a class="reference internal" href="#benchmark_wav.BenchmarkResult" title="benchmark_wav.BenchmarkResult"><span class="pre">BenchmarkResult</span></a><span class="p"><span class="pre">]</span></span></span></em>, <em class="sig-param"><span class="n"><span class="pre">output_file</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><a class="reference external" href="https://docs.python.org/3/library/stdtypes.html#str" title="(in Python v3.14)"><span class="pre">str</span></a></span><span class="w"> </span><span class="o"><span class="pre">=</span></span><span class="w"> </span><span class="default_value"><span class="pre">'benchmark_results.png'</span></span></em><span class="sig-paren">)</span> <span class="sig-return"><span class="sig-return-icon">&#x2192;</span> <span class="sig-return-typehint"><a class="reference external" href="https://docs.python.org/3/library/constants.html#None" title="(in Python v3.14)"><span class="pre">None</span></a></span></span><a class="reference external" href="https://github.com/facebookresearch/spdl/tree/main//examples/benchmark_wav.py?#L326-L385"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#benchmark_wav.plot_benchmark_results" title="Link to this definition">¶</a></dt>
<dd><p>Plot benchmark results and save to file.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters<span class="colon">:</span></dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>results</strong> – List of BenchmarkResult objects containing benchmark data</p></li>
<li><p><strong>output_file</strong> – Output file path for the saved plot</p></li>
</ul>
</dd>
</dl>
</dd></dl>

<dl class="py function">
<dt class="sig sig-object py" id="benchmark_wav.main">
<span class="sig-name descname"><span class="pre">main</span></span><span class="sig-paren">(</span><span class="sig-paren">)</span> <span class="sig-return"><span class="sig-return-icon">&#x2192;</span> <span class="sig-return-typehint"><a class="reference external" href="https://docs.python.org/3/library/constants.html#None" title="(in Python v3.14)"><span class="pre">None</span></a></span></span><a class="reference external" href="https://github.com/facebookresearch/spdl/tree/main//examples/benchmark_wav.py?#L414-L472"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#benchmark_wav.main" title="Link to this definition">¶</a></dt>
<dd><p>Run comprehensive benchmark suite for WAV loading performance.</p>
<p>Benchmarks multiple configurations of audio files with different durations,
comparing spdl.io.load_wav, spdl.io.load_audio, and soundfile libraries
across various thread counts (1, 2, 4, 8, 16).</p>
</dd></dl>

</section>
<section id="classes">
<h2>Classes<a class="headerlink" href="#classes" title="Link to this heading">¶</a></h2>
<p class="rubric">Classes</p>
<dl class="py class">
<dt class="sig sig-object py" id="benchmark_wav.BenchmarkResult">
<em class="property"><span class="pre">class</span><span class="w"> </span></em><span class="sig-name descname"><span class="pre">BenchmarkResult</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">duration</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><a class="reference external" href="https://docs.python.org/3/library/functions.html#float" title="(in Python v3.14)"><span class="pre">float</span></a></span></em>, <em class="sig-param"><span class="n"><span class="pre">qps</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><a class="reference external" href="https://docs.python.org/3/library/functions.html#float" title="(in Python v3.14)"><span class="pre">float</span></a></span></em>, <em class="sig-param"><span class="n"><span class="pre">ci_lower</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><a class="reference external" href="https://docs.python.org/3/library/functions.html#float" title="(in Python v3.14)"><span class="pre">float</span></a></span></em>, <em class="sig-param"><span class="n"><span class="pre">ci_upper</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><a class="reference external" href="https://docs.python.org/3/library/functions.html#float" title="(in Python v3.14)"><span class="pre">float</span></a></span></em>, <em class="sig-param"><span class="n"><span class="pre">num_threads</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><a class="reference external" href="https://docs.python.org/3/library/functions.html#int" title="(in Python v3.14)"><span class="pre">int</span></a></span></em>, <em class="sig-param"><span class="n"><span class="pre">function_name</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><a class="reference external" href="https://docs.python.org/3/library/stdtypes.html#str" title="(in Python v3.14)"><span class="pre">str</span></a></span></em>, <em class="sig-param"><span class="n"><span class="pre">duration_seconds</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><a class="reference external" href="https://docs.python.org/3/library/functions.html#float" title="(in Python v3.14)"><span class="pre">float</span></a></span></em><span class="sig-paren">)</span><a class="reference external" href="https://github.com/facebookresearch/spdl/tree/main//examples/benchmark_wav.py?#L168-L178"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#benchmark_wav.BenchmarkResult" title="Link to this definition">¶</a></dt>
<dd><p>Results from a single benchmark run.</p>
<dl class="py attribute">
<dt class="sig sig-object py" id="benchmark_wav.BenchmarkResult.ci_lower">
<span class="sig-name descname"><span class="pre">ci_lower</span></span><em class="property"><span class="p"><span class="pre">:</span></span><span class="w"> </span><a class="reference external" href="https://docs.python.org/3/library/functions.html#float" title="(in Python v3.14)"><span class="pre">float</span></a></em><a class="headerlink" href="#benchmark_wav.BenchmarkResult.ci_lower" title="Link to this definition">¶</a></dt>
<dd></dd></dl>

<dl class="py attribute">
<dt class="sig sig-object py" id="benchmark_wav.BenchmarkResult.ci_upper">
<span class="sig-name descname"><span class="pre">ci_upper</span></span><em class="property"><span class="p"><span class="pre">:</span></span><span class="w"> </span><a class="reference external" href="https://docs.python.org/3/library/functions.html#float" title="(in Python v3.14)"><span class="pre">float</span></a></em><a class="headerlink" href="#benchmark_wav.BenchmarkResult.ci_upper" title="Link to this definition">¶</a></dt>
<dd></dd></dl>

<dl class="py attribute">
<dt class="sig sig-object py" id="benchmark_wav.BenchmarkResult.duration">
<span class="sig-name descname"><span class="pre">duration</span></span><em class="property"><span class="p"><span class="pre">:</span></span><span class="w"> </span><a class="reference external" href="https://docs.python.org/3/library/functions.html#float" title="(in Python v3.14)"><span class="pre">float</span></a></em><a class="headerlink" href="#benchmark_wav.BenchmarkResult.duration" title="Link to this definition">¶</a></dt>
<dd></dd></dl>

<dl class="py attribute">
<dt class="sig sig-object py" id="benchmark_wav.BenchmarkResult.duration_seconds">
<span class="sig-name descname"><span class="pre">duration_seconds</span></span><em class="property"><span class="p"><span class="pre">:</span></span><span class="w"> </span><a class="reference external" href="https://docs.python.org/3/library/functions.html#float" title="(in Python v3.14)"><span class="pre">float</span></a></em><a class="headerlink" href="#benchmark_wav.BenchmarkResult.duration_seconds" title="Link to this definition">¶</a></dt>
<dd></dd></dl>

<dl class="py attribute">
<dt class="sig sig-object py" id="benchmark_wav.BenchmarkResult.function_name">
<span class="sig-name descname"><span class="pre">function_name</span></span><em class="property"><span class="p"><span class="pre">:</span></span><span class="w"> </span><a class="reference external" href="https://docs.python.org/3/library/stdtypes.html#str" title="(in Python v3.14)"><span class="pre">str</span></a></em><a class="headerlink" href="#benchmark_wav.BenchmarkResult.function_name" title="Link to this definition">¶</a></dt>
<dd></dd></dl>

<dl class="py attribute">
<dt class="sig sig-object py" id="benchmark_wav.BenchmarkResult.num_threads">
<span class="sig-name descname"><span class="pre">num_threads</span></span><em class="property"><span class="p"><span class="pre">:</span></span><span class="w"> </span><a class="reference external" href="https://docs.python.org/3/library/functions.html#int" title="(in Python v3.14)"><span class="pre">int</span></a></em><a class="headerlink" href="#benchmark_wav.BenchmarkResult.num_threads" title="Link to this definition">¶</a></dt>
<dd></dd></dl>

<dl class="py attribute">
<dt class="sig sig-object py" id="benchmark_wav.BenchmarkResult.qps">
<span class="sig-name descname"><span class="pre">qps</span></span><em class="property"><span class="p"><span class="pre">:</span></span><span class="w"> </span><a class="reference external" href="https://docs.python.org/3/library/functions.html#float" title="(in Python v3.14)"><span class="pre">float</span></a></em><a class="headerlink" href="#benchmark_wav.BenchmarkResult.qps" title="Link to this definition">¶</a></dt>
<dd></dd></dl>

</dd></dl>

<dl class="py class">
<dt class="sig sig-object py" id="benchmark_wav.BenchmarkConfig">
<em class="property"><span class="pre">class</span><span class="w"> </span></em><span class="sig-name descname"><span class="pre">BenchmarkConfig</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">sample_rate</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><a class="reference external" href="https://docs.python.org/3/library/functions.html#int" title="(in Python v3.14)"><span class="pre">int</span></a></span></em>, <em class="sig-param"><span class="n"><span class="pre">num_channels</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><a class="reference external" href="https://docs.python.org/3/library/functions.html#int" title="(in Python v3.14)"><span class="pre">int</span></a></span></em>, <em class="sig-param"><span class="n"><span class="pre">bits_per_sample</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><a class="reference external" href="https://docs.python.org/3/library/functions.html#int" title="(in Python v3.14)"><span class="pre">int</span></a></span></em>, <em class="sig-param"><span class="n"><span class="pre">duration_seconds</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><a class="reference external" href="https://docs.python.org/3/library/functions.html#float" title="(in Python v3.14)"><span class="pre">float</span></a></span></em><span class="sig-paren">)</span><a class="reference external" href="https://github.com/facebookresearch/spdl/tree/main//examples/benchmark_wav.py?#L309-L323"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#benchmark_wav.BenchmarkConfig" title="Link to this definition">¶</a></dt>
<dd><p>Configuration for audio file parameters used in benchmarking.</p>
<dl class="py attribute">
<dt class="sig sig-object py" id="benchmark_wav.BenchmarkConfig.sample_rate">
<span class="sig-name descname"><span class="pre">sample_rate</span></span><a class="headerlink" href="#benchmark_wav.BenchmarkConfig.sample_rate" title="Link to this definition">¶</a></dt>
<dd><p>Audio sample rate in Hz (e.g., 44100 for CD quality)</p>
<dl class="field-list simple">
<dt class="field-odd">Type<span class="colon">:</span></dt>
<dd class="field-odd"><p><a class="reference external" href="https://docs.python.org/3/library/functions.html#int" title="(in Python v3.14)">int</a></p>
</dd>
</dl>
</dd></dl>

<dl class="py attribute">
<dt class="sig sig-object py" id="benchmark_wav.BenchmarkConfig.num_channels">
<span class="sig-name descname"><span class="pre">num_channels</span></span><a class="headerlink" href="#benchmark_wav.BenchmarkConfig.num_channels" title="Link to this definition">¶</a></dt>
<dd><p>Number of audio channels (1=mono, 2=stereo, etc.)</p>
<dl class="field-list simple">
<dt class="field-odd">Type<span class="colon">:</span></dt>
<dd class="field-odd"><p><a class="reference external" href="https://docs.python.org/3/library/functions.html#int" title="(in Python v3.14)">int</a></p>
</dd>
</dl>
</dd></dl>

<dl class="py attribute">
<dt class="sig sig-object py" id="benchmark_wav.BenchmarkConfig.bits_per_sample">
<span class="sig-name descname"><span class="pre">bits_per_sample</span></span><a class="headerlink" href="#benchmark_wav.BenchmarkConfig.bits_per_sample" title="Link to this definition">¶</a></dt>
<dd><p>Bit depth per sample (16 or 32)</p>
<dl class="field-list simple">
<dt class="field-odd">Type<span class="colon">:</span></dt>
<dd class="field-odd"><p><a class="reference external" href="https://docs.python.org/3/library/functions.html#int" title="(in Python v3.14)">int</a></p>
</dd>
</dl>
</dd></dl>

<dl class="py attribute">
<dt class="sig sig-object py" id="benchmark_wav.BenchmarkConfig.duration_seconds">
<span class="sig-name descname"><span class="pre">duration_seconds</span></span><a class="headerlink" href="#benchmark_wav.BenchmarkConfig.duration_seconds" title="Link to this definition">¶</a></dt>
<dd><p>Duration of the audio file in seconds</p>
<dl class="field-list simple">
<dt class="field-odd">Type<span class="colon">:</span></dt>
<dd class="field-odd"><p><a class="reference external" href="https://docs.python.org/3/library/functions.html#float" title="(in Python v3.14)">float</a></p>
</dd>
</dl>
</dd></dl>

<dl class="py attribute">
<dt class="sig sig-object py" id="id0">
<span class="sig-name descname"><span class="pre">bits_per_sample</span></span><em class="property"><span class="p"><span class="pre">:</span></span><span class="w"> </span><a class="reference external" href="https://docs.python.org/3/library/functions.html#int" title="(in Python v3.14)"><span class="pre">int</span></a></em><a class="headerlink" href="#id0" title="Link to this definition">¶</a></dt>
<dd></dd></dl>

<dl class="py attribute">
<dt class="sig sig-object py" id="id1">
<span class="sig-name descname"><span class="pre">duration_seconds</span></span><em class="property"><span class="p"><span class="pre">:</span></span><span class="w"> </span><a class="reference external" href="https://docs.python.org/3/library/functions.html#float" title="(in Python v3.14)"><span class="pre">float</span></a></em><a class="headerlink" href="#id1" title="Link to this definition">¶</a></dt>
<dd></dd></dl>

<dl class="py attribute">
<dt class="sig sig-object py" id="id2">
<span class="sig-name descname"><span class="pre">num_channels</span></span><em class="property"><span class="p"><span class="pre">:</span></span><span class="w"> </span><a class="reference external" href="https://docs.python.org/3/library/functions.html#int" title="(in Python v3.14)"><span class="pre">int</span></a></em><a class="headerlink" href="#id2" title="Link to this definition">¶</a></dt>
<dd></dd></dl>

<dl class="py attribute">
<dt class="sig sig-object py" id="id3">
<span class="sig-name descname"><span class="pre">sample_rate</span></span><em class="property"><span class="p"><span class="pre">:</span></span><span class="w"> </span><a class="reference external" href="https://docs.python.org/3/library/functions.html#int" title="(in Python v3.14)"><span class="pre">int</span></a></em><a class="headerlink" href="#id3" title="Link to this definition">¶</a></dt>
<dd></dd></dl>

</dd></dl>

</div></section>
</section>

        </article>
      </div>
      <footer>
        
        <div class="related-pages">
          <a class="next-page" href="benchmark_tarfile.html">
              <div class="page-info">
                <div class="context">
                  <span>Next</span>
                </div>
                <div class="title">Benchmark tarfile</div>
              </div>
              <svg class="furo-related-icon"><use href="#svg-arrow-right"></use></svg>
            </a>
          <a class="prev-page" href="pipeline_profiling.html">
              <svg class="furo-related-icon"><use href="#svg-arrow-right"></use></svg>
              <div class="page-info">
                <div class="context">
                  <span>Previous</span>
                </div>
                
                <div class="title">Pipeline profiling</div>
                
              </div>
            </a>
        </div>
        <div class="bottom-of-page">
          <div class="left-details">
            <div class="copyright">
                Copyright &#169; 2025, Meta Platforms, Inc.
            </div>
            Made with <a href="https://www.sphinx-doc.org/">Sphinx</a> and <a class="muted-link" href="https://pradyunsg.me">@pradyunsg</a>'s
            
            <a href="https://github.com/pradyunsg/furo">Furo</a>
            
          </div>
          <div class="right-details">
            
          </div>
        </div>
        
      </footer>
    </div>
    <aside class="toc-drawer">
      
      
      <div class="toc-sticky toc-scroll">
        <div class="toc-title-container">
          <span class="toc-title">
            On this page
          </span>
        </div>
        <div class="toc-tree-container">
          <div class="toc-tree">
            <ul>
<li><a class="reference internal" href="#">Benchmark wav</a><ul>
<li><a class="reference internal" href="#source">Source</a></li>
<li><a class="reference internal" href="#functions">Functions</a><ul>
<li><a class="reference internal" href="#benchmark_wav.create_wav_data"><code class="docutils literal notranslate"><span class="pre">create_wav_data()</span></code></a></li>
<li><a class="reference internal" href="#benchmark_wav.load_sf"><code class="docutils literal notranslate"><span class="pre">load_sf()</span></code></a></li>
<li><a class="reference internal" href="#benchmark_wav.load_spdl_audio"><code class="docutils literal notranslate"><span class="pre">load_spdl_audio()</span></code></a></li>
<li><a class="reference internal" href="#benchmark_wav.load_spdl_wav"><code class="docutils literal notranslate"><span class="pre">load_spdl_wav()</span></code></a></li>
<li><a class="reference internal" href="#benchmark_wav.benchmark"><code class="docutils literal notranslate"><span class="pre">benchmark()</span></code></a></li>
<li><a class="reference internal" href="#benchmark_wav.run_benchmark_suite"><code class="docutils literal notranslate"><span class="pre">run_benchmark_suite()</span></code></a></li>
<li><a class="reference internal" href="#benchmark_wav.plot_benchmark_results"><code class="docutils literal notranslate"><span class="pre">plot_benchmark_results()</span></code></a></li>
<li><a class="reference internal" href="#benchmark_wav.main"><code class="docutils literal notranslate"><span class="pre">main()</span></code></a></li>
</ul>
</li>
<li><a class="reference internal" href="#classes">Classes</a><ul>
<li><a class="reference internal" href="#benchmark_wav.BenchmarkResult"><code class="docutils literal notranslate"><span class="pre">BenchmarkResult</span></code></a><ul>
<li><a class="reference internal" href="#benchmark_wav.BenchmarkResult.ci_lower"><code class="docutils literal notranslate"><span class="pre">BenchmarkResult.ci_lower</span></code></a></li>
<li><a class="reference internal" href="#benchmark_wav.BenchmarkResult.ci_upper"><code class="docutils literal notranslate"><span class="pre">BenchmarkResult.ci_upper</span></code></a></li>
<li><a class="reference internal" href="#benchmark_wav.BenchmarkResult.duration"><code class="docutils literal notranslate"><span class="pre">BenchmarkResult.duration</span></code></a></li>
<li><a class="reference internal" href="#benchmark_wav.BenchmarkResult.duration_seconds"><code class="docutils literal notranslate"><span class="pre">BenchmarkResult.duration_seconds</span></code></a></li>
<li><a class="reference internal" href="#benchmark_wav.BenchmarkResult.function_name"><code class="docutils literal notranslate"><span class="pre">BenchmarkResult.function_name</span></code></a></li>
<li><a class="reference internal" href="#benchmark_wav.BenchmarkResult.num_threads"><code class="docutils literal notranslate"><span class="pre">BenchmarkResult.num_threads</span></code></a></li>
<li><a class="reference internal" href="#benchmark_wav.BenchmarkResult.qps"><code class="docutils literal notranslate"><span class="pre">BenchmarkResult.qps</span></code></a></li>
</ul>
</li>
<li><a class="reference internal" href="#benchmark_wav.BenchmarkConfig"><code class="docutils literal notranslate"><span class="pre">BenchmarkConfig</span></code></a><ul>
<li><a class="reference internal" href="#benchmark_wav.BenchmarkConfig.sample_rate"><code class="docutils literal notranslate"><span class="pre">BenchmarkConfig.sample_rate</span></code></a></li>
<li><a class="reference internal" href="#benchmark_wav.BenchmarkConfig.num_channels"><code class="docutils literal notranslate"><span class="pre">BenchmarkConfig.num_channels</span></code></a></li>
<li><a class="reference internal" href="#benchmark_wav.BenchmarkConfig.bits_per_sample"><code class="docutils literal notranslate"><span class="pre">BenchmarkConfig.bits_per_sample</span></code></a></li>
<li><a class="reference internal" href="#benchmark_wav.BenchmarkConfig.duration_seconds"><code class="docutils literal notranslate"><span class="pre">BenchmarkConfig.duration_seconds</span></code></a></li>
<li><a class="reference internal" href="#id0"><code class="docutils literal notranslate"><span class="pre">BenchmarkConfig.bits_per_sample</span></code></a></li>
<li><a class="reference internal" href="#id1"><code class="docutils literal notranslate"><span class="pre">BenchmarkConfig.duration_seconds</span></code></a></li>
<li><a class="reference internal" href="#id2"><code class="docutils literal notranslate"><span class="pre">BenchmarkConfig.num_channels</span></code></a></li>
<li><a class="reference internal" href="#id3"><code class="docutils literal notranslate"><span class="pre">BenchmarkConfig.sample_rate</span></code></a></li>
</ul>
</li>
</ul>
</li>
</ul>
</li>
</ul>

          </div>
        </div>
      </div>
      
      
    </aside>
  </div>
</div>
    <script src="../_static/js/custom.js"></script><script src="../_static/documentation_options.js?v=5964c245"></script>
    <script src="../_static/doctools.js?v=9a2dae69"></script>
    <script src="../_static/sphinx_highlight.js?v=dc90522c"></script>
    <script src="../_static/scripts/furo.js?v=5fa4622c"></script>
    <script src="../_static/collapsible-lists/js/CollapsibleLists.compressed.js?v=73120307"></script>
    <script src="../_static/collapsible-lists/js/apply-collapsible-lists.js?v=660e4f45"></script>
    </body>
</html>