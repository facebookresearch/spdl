From 188c5585f28023e95b5addc0405e5d3384df5b2e Mon Sep 17 00:00:00 2001
From: moto <855818+mthrok@users.noreply.github.com>
Date: Sat, 9 Dec 2023 23:22:05 -0500
Subject: [PATCH] Move demangle.h to avoid confusion with binutil

---
 CMakeLists.txt                  | 2 +-
 bazel/glog.bzl                  | 2 +-
 src/demangle.cc                 | 2 +-
 src/{demangle.h => demangle_.h} | 0
 src/demangle_unittest.cc        | 2 +-
 src/symbolize.cc                | 2 +-
 6 files changed, 5 insertions(+), 5 deletions(-)
 rename src/{demangle.h => demangle_.h} (100%)

diff --git a/CMakeLists.txt b/CMakeLists.txt
index 62ebbcc..3938e03 100644
--- a/CMakeLists.txt
+++ b/CMakeLists.txt
@@ -509,7 +509,7 @@ set (GLOG_SRCS
   src/base/googleinit.h
   src/base/mutex.h
   src/demangle.cc
-  src/demangle.h
+  src/demangle_.h
   src/logging.cc
   src/raw_logging.cc
   src/symbolize.cc
diff --git a/bazel/glog.bzl b/bazel/glog.bzl
index 40833b4..9201060 100644
--- a/bazel/glog.bzl
+++ b/bazel/glog.bzl
@@ -117,7 +117,7 @@ def glog_library(namespace = "google", with_gflags = 1, **kwargs):
             "src/base/googleinit.h",
             "src/base/mutex.h",
             "src/demangle.cc",
-            "src/demangle.h",
+            "src/demangle_.h",
             "src/logging.cc",
             "src/raw_logging.cc",
             "src/signalhandler.cc",
diff --git a/src/demangle.cc b/src/demangle.cc
index f3e6ad7..87f053e 100644
--- a/src/demangle.cc
+++ b/src/demangle.cc
@@ -36,7 +36,7 @@
 
 #include <cstdio>  // for NULL
 #include "utilities.h"
-#include "demangle.h"
+#include "demangle_.h"
 
 #if defined(OS_WINDOWS)
 #include <dbghelp.h>
diff --git a/src/demangle.h b/src/demangle_.h
similarity index 100%
rename from src/demangle.h
rename to src/demangle_.h
diff --git a/src/demangle_unittest.cc b/src/demangle_unittest.cc
index be48341..6f4fb85 100644
--- a/src/demangle_unittest.cc
+++ b/src/demangle_unittest.cc
@@ -37,7 +37,7 @@
 #include <fstream>
 #include <string>
 #include "glog/logging.h"
-#include "demangle.h"
+#include "demangle_.h"
 #include "googletest.h"
 #include "config.h"
 
diff --git a/src/symbolize.cc b/src/symbolize.cc
index f7fbc53..fdb44db 100644
--- a/src/symbolize.cc
+++ b/src/symbolize.cc
@@ -62,7 +62,7 @@
 #include <limits>
 
 #include "symbolize.h"
-#include "demangle.h"
+#include "demangle_.h"
 
 _START_GOOGLE_NAMESPACE_
 
-- 
2.40.1

